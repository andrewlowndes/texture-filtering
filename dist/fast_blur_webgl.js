"use strict";(self.webpackChunksampling_coverage=self.webpackChunksampling_coverage||[]).push([[420],{851:(e,t,r)=>{const n=r(7787),o=r(3278),i=r(7601),a=r(8372),l=r(9864),u=r(5350),d=document.getElementById("game"),m=document.getElementById("image"),c=document.getElementById("amount"),s=document.getElementById("amountvalue"),x=document.getElementById("timetaken"),f=d.getContext("webgl2");if(!f)throw new Error("No WebGL2 Support :(");let v,g=8;const p=()=>{const e=i.makeLogScale(0,512);f.clearColor(0,0,0,0);const t=l.createProgramFromShader(f,u.blur),r=f.createVertexArray();if(null===r)throw new Error("Could not create screen triangle");f.bindVertexArray(r);const d=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,d),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),f.STATIC_DRAW);const p=f.createTexture();if(f.bindTexture(f.TEXTURE_2D,p),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,m),f.generateMipmap(f.TEXTURE_2D),m.width*m.height>16777216)throw new Error("Image too big, up to 4096 x 4096 supported");const h=o.createSummedTextureWebgl(a.getImageData(m)),_=f.createTexture();f.bindTexture(f.TEXTURE_2D,_),f.texImage2D(f.TEXTURE_2D,0,f.RGBA32UI,m.width,m.height,0,f.RGBA_INTEGER,f.UNSIGNED_INT,h),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.useProgram(t);const C=f.getAttribLocation(t,"a_position");f.bindBuffer(f.ARRAY_BUFFER,d),f.enableVertexAttribArray(C),f.vertexAttribPointer(C,2,f.FLOAT,!1,0,0);const T=f.getUniformLocation(t,"u_texture");f.uniform1i(T,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,p),v=f.getUniformLocation(t,"u_bluramount");const E=f.getUniformLocation(t,"u_summedtexture");f.uniform1i(E,1),f.activeTexture(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,_);const y=n.createRenderer((()=>{s.value=g.toString(),c.value=e.toLinear(g).toString(),((e,t)=>{const r=Date.now();f.viewport(0,0,f.canvas.width,f.canvas.height),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),f.useProgram(e),f.uniform1f(v,g),f.bindVertexArray(t),f.drawArrays(f.TRIANGLES,0,3),f.readPixels(0,0,1,1,f.RGBA,f.UNSIGNED_BYTE,new Uint8Array(4)),x.innerText=Date.now()-r+" ms"})(t,r)}));c.oninput=()=>{g=parseFloat(e.fromLinear(parseFloat(c.value)).toFixed(1)),y()},s.onchange=()=>{g=parseFloat(s.value),y()},y()};m.complete?p():m.onload=p},7787:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderer=void 0,t.createRenderer=(e,t)=>{let r=!1;return()=>{r||(r=!0,requestAnimationFrame((()=>{e(),r=!1,null==t||t()})))}}},3278:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSummedTextureWebgl=void 0;const n=r(9078),o=r(6196);t.createSummedTextureWebgl=e=>{const t=new Array(e.height);for(let r=0;r<e.height;r++){t[r]=new Array(e.width);for(let i=0;i<e.width;i++){const a=4*((e.height-1-r)*e.width+i),l=new Uint32Array(e.data.slice(a,a+4));i>0&&n.add4Mutate(l,t[r][i-1]),r>0&&n.add4Mutate(l,t[r-1][i]),i>0&&r>0&&o.subtract4Mutate(l,t[r-1][i-1]),t[r][i]=l}}const r=new Uint32Array(e.width*e.height*4);for(let n=0,o=e.height-1;o>=0;o--){const i=t[o];for(let t=0;t<e.width;t++,n+=4){const e=i[t];r[n]=e[0],r[n+1]=e[1],r[n+2]=e[2],r[n+3]=e[3]}}return r}},7601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeLogScale=void 0,t.makeLogScale=(e,t)=>{const r=e?Math.log(e):0,n=Math.log(t)-r;return{fromLinear:e=>Math.exp(r+n*e),toLinear:e=>(Math.log(e)-r)/n}}},5350:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blur=void 0;const n=r(8053);t.blur={version:"300 es",vertex:{head:"\n            in vec2 a_position;\n        ",main:"\n            gl_Position = vec4(a_position, 0.0, 1.0);\n        "},fragment:{dependencies:[n.averageSummed],head:"\n            precision highp float;\n            precision highp usampler2D;\n\n            uniform float u_bluramount;\n            uniform sampler2D u_texture;\n            uniform usampler2D u_summedtexture;\n\n            out vec4 outColor;\n        ",main:"\n            ivec2 fragCoord = ivec2(gl_FragCoord.xy);\n            vec2 tex_size = vec2(textureSize(u_summedtexture, 0));\n\n            vec2 minCoord = clamp(vec2(fragCoord) - u_bluramount, vec2(0.0), tex_size);\n            vec2 maxCoord = clamp(vec2(fragCoord) + u_bluramount, vec2(0.0), tex_size);\n\n            vec4 pixelColour = averageSummed(u_summedtexture, u_texture, minCoord, maxCoord);\n\n            outColor = pixelColour / 255.0;\n        "}}},8053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.averageSummed=void 0;const n=r(4768),o=r(967);t.averageSummed={dependencies:[n.getPixel,o.getSummedArea],text:"\n        //results in up to 24 texture lookups based on complexity of range, whatever size the image is\n        vec4 averageSummed(const in usampler2D summedTexture, const in sampler2D texture, const in vec2 minCoord, const in vec2 maxCoord) {\n            ivec2 startCell = ivec2(floor(minCoord));\n            ivec2 endCell = ivec2(floor(maxCoord));\n\n            //range contained in one pixel\n            if (startCell == endCell) {\n                return texelFetch(texture, ivec2(startCell), 0);\n            }\n            \n            vec2 size = maxCoord - minCoord;\n            float pixelArea = size.x * size.y;\n            float colourNormaliser = 1.0 / pixelArea;\n            \n            ivec2 innerCell = ivec2(ceil(minCoord));\n            ivec2 innerCell2 = ivec2(floor(maxCoord));\n\n            vec2 minDiff = vec2(innerCell) - minCoord;\n            vec2 maxDiff = maxCoord - vec2(innerCell2);\n\n            vec4 colour = vec4(0.0);\n\n            //TODO: optimise by removing branches\n            \n            //single horizontal strip\n            if (startCell.x == endCell.x) {\n                if (minDiff.y > 0.0) {\n                    colour += getPixel(texture, startCell) * size.x * minDiff.y;\n                }\n\n                if (maxDiff.y > 0.0) {\n                    colour += getPixel(texture, endCell) * size.x * maxDiff.y;\n                }\n\n                colour += getSummedArea(summedTexture, ivec2(startCell.x, innerCell.y)-1, ivec2(startCell.x, innerCell2.y-1)) * size.x;\n                return floor(colour * colourNormaliser);\n            }\n            \n            //single vertical strip\n            if (startCell.y == endCell.y) {\n                if (minDiff.x > 0.0) {\n                    colour += getPixel(texture, startCell) * size.y * minDiff.x;\n                }\n\n                if (maxDiff.x > 0.0) {\n                    colour += getPixel(texture, endCell) * size.y * maxDiff.x;\n                }\n\n                colour += getSummedArea(summedTexture, ivec2(innerCell.x, startCell.y)-1, ivec2(innerCell2.x-1, startCell.y)) * size.y;\n                return floor(colour * colourNormaliser);\n            }\n\n            //corner cells\n            if (minDiff.y > 0.0) {\n                if (minDiff.x > 0.0) {\n                    colour += getPixel(texture, startCell) * minDiff.x * minDiff.y;\n                }\n\n                if (maxDiff.x > 0.0) {\n                    colour += getPixel(texture, ivec2(endCell.x, startCell.y)) * maxDiff.x * minDiff.y;\n                }\n            }\n\n            if (maxDiff.y > 0.0) {\n                if (minDiff.x > 0.0) {\n                    colour += getPixel(texture, ivec2(startCell.x, endCell.y)) * minDiff.x * maxDiff.y;\n                }\n\n                if (maxDiff.x > 0.0) {\n                    colour += getPixel(texture, endCell) * maxDiff.x * maxDiff.y;\n                }\n            }\n\n            //fractional strips\n            if (minDiff.y > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(innerCell.x, startCell.y)-1, ivec2(innerCell2.x-1, startCell.y)) * minDiff.y;\n            }\n\n            if (minDiff.x > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(startCell.x, innerCell.y)-1, ivec2(startCell.x, innerCell2.y-1)) * minDiff.x;\n            }\n\n            if (maxDiff.y > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(innerCell.x, endCell.y)-1, ivec2(innerCell2.x-1, endCell.y)) * maxDiff.y;\n            }\n\n            if (maxDiff.x > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(endCell.x, innerCell.y)-1, ivec2(endCell.x, innerCell2.y-1)) * maxDiff.x;\n            }\n\n            //inner parts\n            colour += getSummedArea(summedTexture, ivec2(innerCell)-1, ivec2(innerCell2)-1);\n            \n            //now we have an accumulative pixel value that covers the whole area so just average it\n            return floor(colour * colourNormaliser);\n        }\n    "}},4768:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPixel=void 0,t.getPixel={text:"\n        vec4 getPixel(const in sampler2D texture, const in ivec2 pos) {\n            return texelFetch(texture, pos, 0) * 255.0;\n        }\n    "}},967:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSummedArea=void 0,t.getSummedArea={text:"\n        vec4 getSummedArea(const in usampler2D summedTexture, const in ivec2 minCoord, const in ivec2 maxCoord) {\n            return vec4(texelFetch(summedTexture, maxCoord, 0) - \n                texelFetch(summedTexture, ivec2(minCoord.x, maxCoord.y), 0) + \n                texelFetch(summedTexture, minCoord, 0) -\n                texelFetch(summedTexture, ivec2(maxCoord.x, minCoord.y), 0));\n        }\n    "}},9078:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.add4Mutate=void 0,t.add4Mutate=(e,t)=>(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e)},8372:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImageData=void 0,t.getImageData=e=>{const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");if(!r)throw new Error("Could not create canvas to extract image data");return r.clearRect(0,0,t.width,t.height),r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}},6196:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subtract4Mutate=void 0,t.subtract4Mutate=(e,t)=>(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e[3]-=t[3],e)},5498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildShaderStage=void 0;const n=r(5941);t.buildShaderStage=(e,t)=>{var r;let o=new Set(e.dependencies||[]);const i=new Set(o);let a;const l=e=>{if(e)for(const t of e)i.has(t)?i.delete(t):a.add(t),i.add(t)};for(;o.size;){a=new Set;for(const e of o){if("snippet"in e){const t=e;l(t.snippet.dependencies),l(t.params)}l(e.dependencies)}o=a}const u=Array.from(i.values()).reverse();return`#version ${t}\n\n        ${null!==(r=e.head)&&void 0!==r?r:""}\n\n        ${u.map((e=>{const t=e;return"snippet"in t?n.defineShaderSnippet(t):t.text})).join("\n")}\n    \n        void main(void) {\n            ${e.main}\n        }\n    `}},3795:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProgram=void 0,t.createProgram=(e,t,r)=>{const n=e.createProgram();if(null===n)throw new Error("Could not create program");if(e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){const t=e.getProgramInfoLog(n);throw e.deleteProgram(n),new Error(`Error linking program : ${t}`)}return n}},9864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProgramFromShader=void 0;const n=r(5498),o=r(3795),i=r(5549);t.createProgramFromShader=(e,t)=>{const r=n.buildShaderStage(t.vertex,t.version),a=n.buildShaderStage(t.fragment,t.version),l=i.loadShader(e,r,e.VERTEX_SHADER),u=i.loadShader(e,a,e.FRAGMENT_SHADER);return o.createProgram(e,l,u)}},5941:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defineShaderSnippet=void 0;const n=r(2072);t.defineShaderSnippet=e=>{var t,r;const o=[...e.snippet.params,...e.resultObjs.map((e=>Object.assign(Object.assign({},e),{name:`${n.snippetResult}${e.name}`})))].map((e=>`${e.qualifier} ${e.type} ${e.name}`));return`${null!==(t=e.snippet.returnType)&&void 0!==t?t:"void"} ${e.name}(${o.join(",")}) {\n        ${e.snippet.text(...null!==(r=e.params)&&void 0!==r?r:[])}\n    }`}},5549:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadShader=void 0,t.loadShader=(e,t,r)=>{const n=e.createShader(r);if(null===n)throw new Error("Could not create shader");if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const r=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error(`Error compiling shader: ${r}\n${t.split("\n").map(((e,t)=>`${t+1}:${e}`)).join("\n")}`)}return n}},2072:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.snippetResult=void 0,t.snippetResult="_result_"}},e=>{e(e.s=851)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFRaUcsbUJBQWdCLEVBQ3hCakcsRUFBUWlHLGNBQWdCLGEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy9kZW1vcy9mYXN0Qmx1cldlYmdsLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL2RyYXcvY3JlYXRlUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvZHJhdy9jcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2wudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvbWF0aHMvbWFrZUxvZ1NjYWxlLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3NoYWRlcnMvYmx1ci50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy9zaGFkZXJzL3N1bW1pbmcvYXZlcmFnZVN1bW1lZC50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy9zaGFkZXJzL3N1bW1pbmcvZ2V0UGl4ZWwudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvc2hhZGVycy9zdW1taW5nL2dldFN1bW1lZEFyZWEudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvdXRpbHMvYWRkNE11dGF0ZS50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy91dGlscy9nZXRJbWFnZURhdGEudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvdXRpbHMvc3VidHJhY3Q0TXV0YXRlLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3dlYmdsL2J1aWxkU2hhZGVyU3RhZ2UudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvd2ViZ2wvY3JlYXRlUHJvZ3JhbS50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy93ZWJnbC9jcmVhdGVQcm9ncmFtRnJvbVNoYWRlci50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy93ZWJnbC9kZWZpbmVTaGFkZXJTbmlwcGV0LnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3dlYmdsL2xvYWRTaGFkZXIudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvd2ViZ2wvc25pcHBldFJlc3VsdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBjcmVhdGVSZW5kZXJlcl8xID0gcmVxdWlyZShcIi4uL2RyYXcvY3JlYXRlUmVuZGVyZXJcIik7XHJcbmNvbnN0IGNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbF8xID0gcmVxdWlyZShcIi4uL2RyYXcvY3JlYXRlU3VtbWVkVGV4dHVyZVdlYmdsXCIpO1xyXG5jb25zdCBtYWtlTG9nU2NhbGVfMSA9IHJlcXVpcmUoXCIuLi9tYXRocy9tYWtlTG9nU2NhbGVcIik7XHJcbmNvbnN0IGdldEltYWdlRGF0YV8xID0gcmVxdWlyZShcIi4uL3V0aWxzL2dldEltYWdlRGF0YVwiKTtcclxuY29uc3QgY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXJfMSA9IHJlcXVpcmUoXCIuLi93ZWJnbC9jcmVhdGVQcm9ncmFtRnJvbVNoYWRlclwiKTtcclxuY29uc3QgYmx1cl8xID0gcmVxdWlyZShcIi4uL3NoYWRlcnMvYmx1clwiKTtcclxuY29uc3QgZ2FtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZVwiKTtcclxuY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlXCIpO1xyXG5jb25zdCBhbW91bnRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW1vdW50XCIpO1xyXG5jb25zdCBhbW91bnRWYWx1ZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbW91bnR2YWx1ZVwiKTtcclxuY29uc3QgdGltZXRha2VuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aW1ldGFrZW5cIik7XHJcbi8vbmVlZCB0byB1c2Ugd2ViZ2wgMiB0byBiZSBhYmxlIHRvIGNyZWF0ZSBhIHN1aXRhYmxlIHN1bW1lZCB0ZXh0dXJlIHdpdGhvdXQgY29tcHJlc3Npb25cclxuY29uc3QgZ2wgPSBnYW1lLmdldENvbnRleHQoXCJ3ZWJnbDJcIik7XHJcbmlmICghZ2wpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIk5vIFdlYkdMMiBTdXBwb3J0IDooXCIpO1xyXG59XHJcbmxldCBibHVyQW1vdW50ID0gODtcclxubGV0IGJsdXJVbmlmb3JtTG9jYXRpb247XHJcbmNvbnN0IHJlbmRlciA9IChwcm9ncmFtLCBzY3JlZW5UcmlhbmdsZSkgPT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGdsLnZpZXdwb3J0KDAsIDAsIGdsLmNhbnZhcy53aWR0aCwgZ2wuY2FudmFzLmhlaWdodCk7XHJcbiAgICBnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUIHwgZ2wuREVQVEhfQlVGRkVSX0JJVCk7XHJcbiAgICAvL2RyYXcgb3VyIHNpbmdsZSB0cmlhbmdsZVxyXG4gICAgZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgIGdsLnVuaWZvcm0xZihibHVyVW5pZm9ybUxvY2F0aW9uLCBibHVyQW1vdW50KTtcclxuICAgIGdsLmJpbmRWZXJ0ZXhBcnJheShzY3JlZW5UcmlhbmdsZSk7XHJcbiAgICBnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFUywgMCwgMyk7XHJcbiAgICBnbC5yZWFkUGl4ZWxzKDAsIDAsIDEsIDEsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsIG5ldyBVaW50OEFycmF5KDQpKTtcclxuICAgIHRpbWV0YWtlbi5pbm5lclRleHQgPSBgJHsoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSl9IG1zYDtcclxufTtcclxuY29uc3Qgc3RhcnQgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBibHVyTG9nU2NhbGUgPSBtYWtlTG9nU2NhbGVfMS5tYWtlTG9nU2NhbGUoMCwgNTEyKTtcclxuICAgIGdsLmNsZWFyQ29sb3IoMCwgMCwgMCwgMCk7XHJcbiAgICBjb25zdCBwcm9ncmFtID0gY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXJfMS5jcmVhdGVQcm9ncmFtRnJvbVNoYWRlcihnbCwgYmx1cl8xLmJsdXIpO1xyXG4gICAgLy9idWZmZXJzXHJcbiAgICBjb25zdCBzY3JlZW5UcmlhbmdsZSA9IGdsLmNyZWF0ZVZlcnRleEFycmF5KCk7XHJcbiAgICBpZiAoc2NyZWVuVHJpYW5nbGUgPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBjcmVhdGUgc2NyZWVuIHRyaWFuZ2xlJyk7XHJcbiAgICB9XHJcbiAgICBnbC5iaW5kVmVydGV4QXJyYXkoc2NyZWVuVHJpYW5nbGUpO1xyXG4gICAgY29uc3QgcG9zaXRpb25CdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTtcclxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBwb3NpdGlvbkJ1ZmZlcik7XHJcbiAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgbmV3IEZsb2F0MzJBcnJheShbLTEsIC0xLCAzLCAtMSwgLTEsIDNdKSwgZ2wuU1RBVElDX0RSQVcpO1xyXG4gICAgLy8gLSBvcmlnaW5hbCB0ZXh0dXJlXHJcbiAgICBjb25zdCB0ZXh0dXJlID0gZ2wuY3JlYXRlVGV4dHVyZSgpO1xyXG4gICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGV4dHVyZSk7XHJcbiAgICBnbC5waXhlbFN0b3JlaShnbC5VTlBBQ0tfRkxJUF9ZX1dFQkdMLCB0cnVlKTtcclxuICAgIGdsLnRleEltYWdlMkQoZ2wuVEVYVFVSRV8yRCwgMCwgZ2wuUkdCQSwgZ2wuUkdCQSwgZ2wuVU5TSUdORURfQllURSwgaW1hZ2UpO1xyXG4gICAgZ2wuZ2VuZXJhdGVNaXBtYXAoZ2wuVEVYVFVSRV8yRCk7XHJcbiAgICAvLyAtIHN1bW1lZCB0ZXh0dXJlXHJcbiAgICAvLyBmbGF0dGVuIHRoZSBwcm9kdWNlZCBzdW1tZWQgaW1hZ2Ugc28gaXQgaXMgc3VpdGFibGUgZm9yIGNyZWF0aW5nIGEgdGV4dHVyZSBvdXQgb2YgaXRcclxuICAgIC8vIG9uY2Ugd2UgaGF2ZSBnZW5lcmF0ZWQgb3VyIHN1bW1tZWQgdGV4dHVyZSB3ZSBjYW4gcGFzcyBpdCB0byBvdXIgc2hhZGVycyB1c2luZyBSR0JBMzJVSSBmb3JtYXQgKDQgYnl0ZSB1bnNpZ25lZCBpbnQgcGVyIGNoYW5uZWwpXHJcbiAgICAvLyB0aGlzIG1lYW5zIHRoZSBzdW1tZWQgdGV4dHVyZSBjYW4gc3VwcG9ydCBzdW1taW5nIGZvciB0ZXh0dXJlcyBvZiB1cCB0byA0MDk2IHggNDA5NiAocGxlbnR5KVxyXG4gICAgY29uc3QgbWF4UGl4ZWxzID0gNDA5NiAqIDQwOTY7XHJcbiAgICBpZiAoaW1hZ2Uud2lkdGggKiBpbWFnZS5oZWlnaHQgPiBtYXhQaXhlbHMpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbWFnZSB0b28gYmlnLCB1cCB0byA0MDk2IHggNDA5NiBzdXBwb3J0ZWRcIik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBzdW1tZWRJbWFnZSA9IGNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbF8xLmNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbChnZXRJbWFnZURhdGFfMS5nZXRJbWFnZURhdGEoaW1hZ2UpKTtcclxuICAgIGNvbnN0IHN1bW1lZFRleHR1cmUgPSBnbC5jcmVhdGVUZXh0dXJlKCk7XHJcbiAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBzdW1tZWRUZXh0dXJlKTtcclxuICAgIGdsLnRleEltYWdlMkQoZ2wuVEVYVFVSRV8yRCwgMCwgZ2wuUkdCQTMyVUksIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQsIDAsIGdsLlJHQkFfSU5URUdFUiwgZ2wuVU5TSUdORURfSU5ULCBzdW1tZWRJbWFnZSk7XHJcbiAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUFHX0ZJTFRFUiwgZ2wuTkVBUkVTVCk7XHJcbiAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgZ2wuTkVBUkVTVCk7XHJcbiAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9TLCBnbC5DTEFNUF9UT19FREdFKTtcclxuICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9XUkFQX1QsIGdsLkNMQU1QX1RPX0VER0UpO1xyXG4gICAgLy9iaW5kIGJ1ZmZlcnMgdG8gc2hhZGVyXHJcbiAgICBnbC51c2VQcm9ncmFtKHByb2dyYW0pO1xyXG4gICAgY29uc3QgcG9zaXRpb25BdHRyaWJ1dGVMb2NhdGlvbiA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByb2dyYW0sIFwiYV9wb3NpdGlvblwiKTtcclxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBwb3NpdGlvbkJ1ZmZlcik7XHJcbiAgICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShwb3NpdGlvbkF0dHJpYnV0ZUxvY2F0aW9uKTtcclxuICAgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIocG9zaXRpb25BdHRyaWJ1dGVMb2NhdGlvbiwgMiwgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcclxuICAgIGNvbnN0IHRleHR1cmVVbmlmb3JtTG9jYXRpb24gPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgXCJ1X3RleHR1cmVcIik7XHJcbiAgICBnbC51bmlmb3JtMWkodGV4dHVyZVVuaWZvcm1Mb2NhdGlvbiwgMCk7XHJcbiAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwKTtcclxuICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRleHR1cmUpO1xyXG4gICAgYmx1clVuaWZvcm1Mb2NhdGlvbiA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCBcInVfYmx1cmFtb3VudFwiKTtcclxuICAgIGNvbnN0IHN1bW1lZFRleHR1cmVVbmlmb3JtTG9jYXRpb24gPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgXCJ1X3N1bW1lZHRleHR1cmVcIik7XHJcbiAgICBnbC51bmlmb3JtMWkoc3VtbWVkVGV4dHVyZVVuaWZvcm1Mb2NhdGlvbiwgMSk7XHJcbiAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUxKTtcclxuICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHN1bW1lZFRleHR1cmUpO1xyXG4gICAgLy9pbnB1dHNcclxuICAgIGNvbnN0IGRyYXcgPSBjcmVhdGVSZW5kZXJlcl8xLmNyZWF0ZVJlbmRlcmVyKCgpID0+IHtcclxuICAgICAgICBhbW91bnRWYWx1ZUlucHV0LnZhbHVlID0gYmx1ckFtb3VudC50b1N0cmluZygpO1xyXG4gICAgICAgIGFtb3VudElucHV0LnZhbHVlID0gYmx1ckxvZ1NjYWxlLnRvTGluZWFyKGJsdXJBbW91bnQpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcmVuZGVyKHByb2dyYW0sIHNjcmVlblRyaWFuZ2xlKTtcclxuICAgIH0pO1xyXG4gICAgYW1vdW50SW5wdXQub25pbnB1dCA9ICgpID0+IHtcclxuICAgICAgICAvL2NvbnZlcnQgdGhlIHNsaWRlciB2YWx1ZSBhcyBpZiBpdCB3YXMgZXhwb25lbnRpYWxcclxuICAgICAgICBibHVyQW1vdW50ID0gcGFyc2VGbG9hdChibHVyTG9nU2NhbGUuZnJvbUxpbmVhcihwYXJzZUZsb2F0KGFtb3VudElucHV0LnZhbHVlKSkudG9GaXhlZCgxKSk7XHJcbiAgICAgICAgZHJhdygpO1xyXG4gICAgfTtcclxuICAgIGFtb3VudFZhbHVlSW5wdXQub25jaGFuZ2UgPSAoKSA9PiB7XHJcbiAgICAgICAgYmx1ckFtb3VudCA9IHBhcnNlRmxvYXQoYW1vdW50VmFsdWVJbnB1dC52YWx1ZSk7XHJcbiAgICAgICAgZHJhdygpO1xyXG4gICAgfTtcclxuICAgIGRyYXcoKTtcclxufTtcclxuaWYgKGltYWdlLmNvbXBsZXRlKSB7XHJcbiAgICBzdGFydCgpO1xyXG59XHJcbmVsc2Uge1xyXG4gICAgaW1hZ2Uub25sb2FkID0gc3RhcnQ7XHJcbn1cclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5jcmVhdGVSZW5kZXJlciA9IHZvaWQgMDtcclxuY29uc3QgY3JlYXRlUmVuZGVyZXIgPSAocmVuZGVyRnVuYywgYWZ0ZXJSZW5kZXJGdW5jKSA9PiB7XHJcbiAgICBsZXQgZHJhd2luZyA9IGZhbHNlO1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICBpZiAoIWRyYXdpbmcpIHtcclxuICAgICAgICAgICAgZHJhd2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJGdW5jKCk7XHJcbiAgICAgICAgICAgICAgICBkcmF3aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBhZnRlclJlbmRlckZ1bmMgPT09IG51bGwgfHwgYWZ0ZXJSZW5kZXJGdW5jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhZnRlclJlbmRlckZ1bmMoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuZXhwb3J0cy5jcmVhdGVSZW5kZXJlciA9IGNyZWF0ZVJlbmRlcmVyO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbCA9IHZvaWQgMDtcclxuY29uc3QgYWRkNE11dGF0ZV8xID0gcmVxdWlyZShcIi4uL3V0aWxzL2FkZDRNdXRhdGVcIik7XHJcbmNvbnN0IHN1YnRyYWN0NE11dGF0ZV8xID0gcmVxdWlyZShcIi4uL3V0aWxzL3N1YnRyYWN0NE11dGF0ZVwiKTtcclxuLy9zaW1pbGFyIHRvIGNyZWF0ZVN1bW1lZFRleHR1cmUgZXhjZXB0IGNyZWF0ZXMgYSBzaW5nbGUgdWludDMyIGFycmF5IGFuZCBmbGlwcyB0aGUgeSBvZiB0aGUgaW1hZ2VcclxuY29uc3QgY3JlYXRlU3VtbWVkVGV4dHVyZVdlYmdsID0gKGltYWdlRGF0YSkgPT4ge1xyXG4gICAgY29uc3Qgc3VtbWVkVGV4dHVyZSA9IG5ldyBBcnJheShpbWFnZURhdGEuaGVpZ2h0KTtcclxuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgaW1hZ2VEYXRhLmhlaWdodDsgeSsrKSB7XHJcbiAgICAgICAgc3VtbWVkVGV4dHVyZVt5XSA9IG5ldyBBcnJheShpbWFnZURhdGEud2lkdGgpO1xyXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgaW1hZ2VEYXRhLndpZHRoOyB4KyspIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9ICgoaW1hZ2VEYXRhLmhlaWdodCAtIDEgLSB5KSAqIGltYWdlRGF0YS53aWR0aCArIHgpICogNDtcclxuICAgICAgICAgICAgY29uc3QgcGl4ID0gbmV3IFVpbnQzMkFycmF5KGltYWdlRGF0YS5kYXRhLnNsaWNlKGksIGkgKyA0KSk7XHJcbiAgICAgICAgICAgIGlmICh4ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgYWRkNE11dGF0ZV8xLmFkZDRNdXRhdGUocGl4LCBzdW1tZWRUZXh0dXJlW3ldW3ggLSAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhZGQ0TXV0YXRlXzEuYWRkNE11dGF0ZShwaXgsIHN1bW1lZFRleHR1cmVbeSAtIDFdW3hdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoeCA+IDAgJiYgeSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHN1YnRyYWN0NE11dGF0ZV8xLnN1YnRyYWN0NE11dGF0ZShwaXgsIHN1bW1lZFRleHR1cmVbeSAtIDFdW3ggLSAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3VtbWVkVGV4dHVyZVt5XVt4XSA9IHBpeDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBzdW1tZWRJbWFnZVJhdyA9IG5ldyBVaW50MzJBcnJheShpbWFnZURhdGEud2lkdGggKiBpbWFnZURhdGEuaGVpZ2h0ICogNCk7XHJcbiAgICBmb3IgKGxldCBpID0gMCwgeSA9IGltYWdlRGF0YS5oZWlnaHQgLSAxOyB5ID49IDA7IHktLSkge1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IHN1bW1lZFRleHR1cmVbeV07XHJcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBpbWFnZURhdGEud2lkdGg7IHgrKywgaSArPSA0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBpeCA9IHJvd1t4XTtcclxuICAgICAgICAgICAgc3VtbWVkSW1hZ2VSYXdbaV0gPSBwaXhbMF07XHJcbiAgICAgICAgICAgIHN1bW1lZEltYWdlUmF3W2kgKyAxXSA9IHBpeFsxXTtcclxuICAgICAgICAgICAgc3VtbWVkSW1hZ2VSYXdbaSArIDJdID0gcGl4WzJdO1xyXG4gICAgICAgICAgICBzdW1tZWRJbWFnZVJhd1tpICsgM10gPSBwaXhbM107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN1bW1lZEltYWdlUmF3O1xyXG59O1xyXG5leHBvcnRzLmNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbCA9IGNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbDtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5tYWtlTG9nU2NhbGUgPSB2b2lkIDA7XHJcbmNvbnN0IG1ha2VMb2dTY2FsZSA9IChmcm9tLCB0bykgPT4ge1xyXG4gICAgY29uc3QgbWluID0gZnJvbSA/IE1hdGgubG9nKGZyb20pIDogMDtcclxuICAgIGNvbnN0IG1heCA9IE1hdGgubG9nKHRvKTtcclxuICAgIGNvbnN0IHNjYWxlID0gbWF4IC0gbWluO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBmcm9tTGluZWFyOiAodmFsdWUpID0+IE1hdGguZXhwKG1pbiArIHNjYWxlICogdmFsdWUpLFxyXG4gICAgICAgIHRvTGluZWFyOiAobG9nVmFsdWUpID0+IChNYXRoLmxvZyhsb2dWYWx1ZSkgLSBtaW4pIC8gc2NhbGVcclxuICAgIH07XHJcbn07XHJcbmV4cG9ydHMubWFrZUxvZ1NjYWxlID0gbWFrZUxvZ1NjYWxlO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmJsdXIgPSB2b2lkIDA7XHJcbmNvbnN0IGF2ZXJhZ2VTdW1tZWRfMSA9IHJlcXVpcmUoXCIuL3N1bW1pbmcvYXZlcmFnZVN1bW1lZFwiKTtcclxuZXhwb3J0cy5ibHVyID0ge1xyXG4gICAgdmVyc2lvbjogXCIzMDAgZXNcIixcclxuICAgIHZlcnRleDoge1xyXG4gICAgICAgIGhlYWQ6IC8qIGdsc2wgKi8gYFxyXG4gICAgICAgICAgICBpbiB2ZWMyIGFfcG9zaXRpb247XHJcbiAgICAgICAgYCxcclxuICAgICAgICBtYWluOiAvKiBnbHNsICovIGBcclxuICAgICAgICAgICAgZ2xfUG9zaXRpb24gPSB2ZWM0KGFfcG9zaXRpb24sIDAuMCwgMS4wKTtcclxuICAgICAgICBgXHJcbiAgICB9LFxyXG4gICAgZnJhZ21lbnQ6IHtcclxuICAgICAgICBkZXBlbmRlbmNpZXM6IFthdmVyYWdlU3VtbWVkXzEuYXZlcmFnZVN1bW1lZF0sXHJcbiAgICAgICAgaGVhZDogLyogZ2xzbCAqLyBgXHJcbiAgICAgICAgICAgIHByZWNpc2lvbiBoaWdocCBmbG9hdDtcclxuICAgICAgICAgICAgcHJlY2lzaW9uIGhpZ2hwIHVzYW1wbGVyMkQ7XHJcblxyXG4gICAgICAgICAgICB1bmlmb3JtIGZsb2F0IHVfYmx1cmFtb3VudDtcclxuICAgICAgICAgICAgdW5pZm9ybSBzYW1wbGVyMkQgdV90ZXh0dXJlO1xyXG4gICAgICAgICAgICB1bmlmb3JtIHVzYW1wbGVyMkQgdV9zdW1tZWR0ZXh0dXJlO1xyXG5cclxuICAgICAgICAgICAgb3V0IHZlYzQgb3V0Q29sb3I7XHJcbiAgICAgICAgYCxcclxuICAgICAgICBtYWluOiAvKiBnbHNsICovIGBcclxuICAgICAgICAgICAgaXZlYzIgZnJhZ0Nvb3JkID0gaXZlYzIoZ2xfRnJhZ0Nvb3JkLnh5KTtcclxuICAgICAgICAgICAgdmVjMiB0ZXhfc2l6ZSA9IHZlYzIodGV4dHVyZVNpemUodV9zdW1tZWR0ZXh0dXJlLCAwKSk7XHJcblxyXG4gICAgICAgICAgICB2ZWMyIG1pbkNvb3JkID0gY2xhbXAodmVjMihmcmFnQ29vcmQpIC0gdV9ibHVyYW1vdW50LCB2ZWMyKDAuMCksIHRleF9zaXplKTtcclxuICAgICAgICAgICAgdmVjMiBtYXhDb29yZCA9IGNsYW1wKHZlYzIoZnJhZ0Nvb3JkKSArIHVfYmx1cmFtb3VudCwgdmVjMigwLjApLCB0ZXhfc2l6ZSk7XHJcblxyXG4gICAgICAgICAgICB2ZWM0IHBpeGVsQ29sb3VyID0gYXZlcmFnZVN1bW1lZCh1X3N1bW1lZHRleHR1cmUsIHVfdGV4dHVyZSwgbWluQ29vcmQsIG1heENvb3JkKTtcclxuXHJcbiAgICAgICAgICAgIG91dENvbG9yID0gcGl4ZWxDb2xvdXIgLyAyNTUuMDtcclxuICAgICAgICBgXHJcbiAgICB9XHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuYXZlcmFnZVN1bW1lZCA9IHZvaWQgMDtcclxuY29uc3QgZ2V0UGl4ZWxfMSA9IHJlcXVpcmUoXCIuL2dldFBpeGVsXCIpO1xyXG5jb25zdCBnZXRTdW1tZWRBcmVhXzEgPSByZXF1aXJlKFwiLi9nZXRTdW1tZWRBcmVhXCIpO1xyXG5leHBvcnRzLmF2ZXJhZ2VTdW1tZWQgPSB7XHJcbiAgICBkZXBlbmRlbmNpZXM6IFtnZXRQaXhlbF8xLmdldFBpeGVsLCBnZXRTdW1tZWRBcmVhXzEuZ2V0U3VtbWVkQXJlYV0sXHJcbiAgICB0ZXh0OiAvKiBnbHNsICovIGBcclxuICAgICAgICAvL3Jlc3VsdHMgaW4gdXAgdG8gMjQgdGV4dHVyZSBsb29rdXBzIGJhc2VkIG9uIGNvbXBsZXhpdHkgb2YgcmFuZ2UsIHdoYXRldmVyIHNpemUgdGhlIGltYWdlIGlzXHJcbiAgICAgICAgdmVjNCBhdmVyYWdlU3VtbWVkKGNvbnN0IGluIHVzYW1wbGVyMkQgc3VtbWVkVGV4dHVyZSwgY29uc3QgaW4gc2FtcGxlcjJEIHRleHR1cmUsIGNvbnN0IGluIHZlYzIgbWluQ29vcmQsIGNvbnN0IGluIHZlYzIgbWF4Q29vcmQpIHtcclxuICAgICAgICAgICAgaXZlYzIgc3RhcnRDZWxsID0gaXZlYzIoZmxvb3IobWluQ29vcmQpKTtcclxuICAgICAgICAgICAgaXZlYzIgZW5kQ2VsbCA9IGl2ZWMyKGZsb29yKG1heENvb3JkKSk7XHJcblxyXG4gICAgICAgICAgICAvL3JhbmdlIGNvbnRhaW5lZCBpbiBvbmUgcGl4ZWxcclxuICAgICAgICAgICAgaWYgKHN0YXJ0Q2VsbCA9PSBlbmRDZWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4ZWxGZXRjaCh0ZXh0dXJlLCBpdmVjMihzdGFydENlbGwpLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmVjMiBzaXplID0gbWF4Q29vcmQgLSBtaW5Db29yZDtcclxuICAgICAgICAgICAgZmxvYXQgcGl4ZWxBcmVhID0gc2l6ZS54ICogc2l6ZS55O1xyXG4gICAgICAgICAgICBmbG9hdCBjb2xvdXJOb3JtYWxpc2VyID0gMS4wIC8gcGl4ZWxBcmVhO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaXZlYzIgaW5uZXJDZWxsID0gaXZlYzIoY2VpbChtaW5Db29yZCkpO1xyXG4gICAgICAgICAgICBpdmVjMiBpbm5lckNlbGwyID0gaXZlYzIoZmxvb3IobWF4Q29vcmQpKTtcclxuXHJcbiAgICAgICAgICAgIHZlYzIgbWluRGlmZiA9IHZlYzIoaW5uZXJDZWxsKSAtIG1pbkNvb3JkO1xyXG4gICAgICAgICAgICB2ZWMyIG1heERpZmYgPSBtYXhDb29yZCAtIHZlYzIoaW5uZXJDZWxsMik7XHJcblxyXG4gICAgICAgICAgICB2ZWM0IGNvbG91ciA9IHZlYzQoMC4wKTtcclxuXHJcbiAgICAgICAgICAgIC8vVE9ETzogb3B0aW1pc2UgYnkgcmVtb3ZpbmcgYnJhbmNoZXNcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vc2luZ2xlIGhvcml6b250YWwgc3RyaXBcclxuICAgICAgICAgICAgaWYgKHN0YXJ0Q2VsbC54ID09IGVuZENlbGwueCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1pbkRpZmYueSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRQaXhlbCh0ZXh0dXJlLCBzdGFydENlbGwpICogc2l6ZS54ICogbWluRGlmZi55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXhEaWZmLnkgPiAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0UGl4ZWwodGV4dHVyZSwgZW5kQ2VsbCkgKiBzaXplLnggKiBtYXhEaWZmLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoc3RhcnRDZWxsLngsIGlubmVyQ2VsbC55KS0xLCBpdmVjMihzdGFydENlbGwueCwgaW5uZXJDZWxsMi55LTEpKSAqIHNpemUueDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmbG9vcihjb2xvdXIgKiBjb2xvdXJOb3JtYWxpc2VyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy9zaW5nbGUgdmVydGljYWwgc3RyaXBcclxuICAgICAgICAgICAgaWYgKHN0YXJ0Q2VsbC55ID09IGVuZENlbGwueSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1pbkRpZmYueCA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRQaXhlbCh0ZXh0dXJlLCBzdGFydENlbGwpICogc2l6ZS55ICogbWluRGlmZi54O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXhEaWZmLnggPiAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0UGl4ZWwodGV4dHVyZSwgZW5kQ2VsbCkgKiBzaXplLnkgKiBtYXhEaWZmLng7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoaW5uZXJDZWxsLngsIHN0YXJ0Q2VsbC55KS0xLCBpdmVjMihpbm5lckNlbGwyLngtMSwgc3RhcnRDZWxsLnkpKSAqIHNpemUueTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmbG9vcihjb2xvdXIgKiBjb2xvdXJOb3JtYWxpc2VyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy9jb3JuZXIgY2VsbHNcclxuICAgICAgICAgICAgaWYgKG1pbkRpZmYueSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1pbkRpZmYueCA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRQaXhlbCh0ZXh0dXJlLCBzdGFydENlbGwpICogbWluRGlmZi54ICogbWluRGlmZi55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXhEaWZmLnggPiAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0UGl4ZWwodGV4dHVyZSwgaXZlYzIoZW5kQ2VsbC54LCBzdGFydENlbGwueSkpICogbWF4RGlmZi54ICogbWluRGlmZi55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobWF4RGlmZi55ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWluRGlmZi54ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFBpeGVsKHRleHR1cmUsIGl2ZWMyKHN0YXJ0Q2VsbC54LCBlbmRDZWxsLnkpKSAqIG1pbkRpZmYueCAqIG1heERpZmYueTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobWF4RGlmZi54ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFBpeGVsKHRleHR1cmUsIGVuZENlbGwpICogbWF4RGlmZi54ICogbWF4RGlmZi55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL2ZyYWN0aW9uYWwgc3RyaXBzXHJcbiAgICAgICAgICAgIGlmIChtaW5EaWZmLnkgPiAwLjApIHtcclxuICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRTdW1tZWRBcmVhKHN1bW1lZFRleHR1cmUsIGl2ZWMyKGlubmVyQ2VsbC54LCBzdGFydENlbGwueSktMSwgaXZlYzIoaW5uZXJDZWxsMi54LTEsIHN0YXJ0Q2VsbC55KSkgKiBtaW5EaWZmLnk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtaW5EaWZmLnggPiAwLjApIHtcclxuICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRTdW1tZWRBcmVhKHN1bW1lZFRleHR1cmUsIGl2ZWMyKHN0YXJ0Q2VsbC54LCBpbm5lckNlbGwueSktMSwgaXZlYzIoc3RhcnRDZWxsLngsIGlubmVyQ2VsbDIueS0xKSkgKiBtaW5EaWZmLng7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtYXhEaWZmLnkgPiAwLjApIHtcclxuICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRTdW1tZWRBcmVhKHN1bW1lZFRleHR1cmUsIGl2ZWMyKGlubmVyQ2VsbC54LCBlbmRDZWxsLnkpLTEsIGl2ZWMyKGlubmVyQ2VsbDIueC0xLCBlbmRDZWxsLnkpKSAqIG1heERpZmYueTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG1heERpZmYueCA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoZW5kQ2VsbC54LCBpbm5lckNlbGwueSktMSwgaXZlYzIoZW5kQ2VsbC54LCBpbm5lckNlbGwyLnktMSkpICogbWF4RGlmZi54O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL2lubmVyIHBhcnRzXHJcbiAgICAgICAgICAgIGNvbG91ciArPSBnZXRTdW1tZWRBcmVhKHN1bW1lZFRleHR1cmUsIGl2ZWMyKGlubmVyQ2VsbCktMSwgaXZlYzIoaW5uZXJDZWxsMiktMSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvL25vdyB3ZSBoYXZlIGFuIGFjY3VtdWxhdGl2ZSBwaXhlbCB2YWx1ZSB0aGF0IGNvdmVycyB0aGUgd2hvbGUgYXJlYSBzbyBqdXN0IGF2ZXJhZ2UgaXRcclxuICAgICAgICAgICAgcmV0dXJuIGZsb29yKGNvbG91ciAqIGNvbG91ck5vcm1hbGlzZXIpO1xyXG4gICAgICAgIH1cclxuICAgIGBcclxufTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5nZXRQaXhlbCA9IHZvaWQgMDtcclxuZXhwb3J0cy5nZXRQaXhlbCA9IHtcclxuICAgIHRleHQ6IC8qIGdsc2wgKi8gYFxyXG4gICAgICAgIHZlYzQgZ2V0UGl4ZWwoY29uc3QgaW4gc2FtcGxlcjJEIHRleHR1cmUsIGNvbnN0IGluIGl2ZWMyIHBvcykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGV4ZWxGZXRjaCh0ZXh0dXJlLCBwb3MsIDApICogMjU1LjA7XHJcbiAgICAgICAgfVxyXG4gICAgYFxyXG59O1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmdldFN1bW1lZEFyZWEgPSB2b2lkIDA7XHJcbmV4cG9ydHMuZ2V0U3VtbWVkQXJlYSA9IHtcclxuICAgIHRleHQ6IC8qIGdsc2wgKi8gYFxyXG4gICAgICAgIHZlYzQgZ2V0U3VtbWVkQXJlYShjb25zdCBpbiB1c2FtcGxlcjJEIHN1bW1lZFRleHR1cmUsIGNvbnN0IGluIGl2ZWMyIG1pbkNvb3JkLCBjb25zdCBpbiBpdmVjMiBtYXhDb29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmVjNCh0ZXhlbEZldGNoKHN1bW1lZFRleHR1cmUsIG1heENvb3JkLCAwKSAtIFxyXG4gICAgICAgICAgICAgICAgdGV4ZWxGZXRjaChzdW1tZWRUZXh0dXJlLCBpdmVjMihtaW5Db29yZC54LCBtYXhDb29yZC55KSwgMCkgKyBcclxuICAgICAgICAgICAgICAgIHRleGVsRmV0Y2goc3VtbWVkVGV4dHVyZSwgbWluQ29vcmQsIDApIC1cclxuICAgICAgICAgICAgICAgIHRleGVsRmV0Y2goc3VtbWVkVGV4dHVyZSwgaXZlYzIobWF4Q29vcmQueCwgbWluQ29vcmQueSksIDApKTtcclxuICAgICAgICB9XHJcbiAgICBgXHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuYWRkNE11dGF0ZSA9IHZvaWQgMDtcclxuY29uc3QgYWRkNE11dGF0ZSA9IChhLCBiKSA9PiB7XHJcbiAgICBhWzBdICs9IGJbMF07XHJcbiAgICBhWzFdICs9IGJbMV07XHJcbiAgICBhWzJdICs9IGJbMl07XHJcbiAgICBhWzNdICs9IGJbM107XHJcbiAgICByZXR1cm4gYTtcclxufTtcclxuZXhwb3J0cy5hZGQ0TXV0YXRlID0gYWRkNE11dGF0ZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5nZXRJbWFnZURhdGEgPSB2b2lkIDA7XHJcbmNvbnN0IGdldEltYWdlRGF0YSA9IChpbWFnZSkgPT4ge1xyXG4gICAgY29uc3QgaW1hZ2VDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgIGltYWdlQ2FudmFzLndpZHRoID0gaW1hZ2Uud2lkdGg7XHJcbiAgICBpbWFnZUNhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XHJcbiAgICBjb25zdCBpbWFnZUdyYXBoaWNzID0gaW1hZ2VDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgIGlmICghaW1hZ2VHcmFwaGljcykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGNyZWF0ZSBjYW52YXMgdG8gZXh0cmFjdCBpbWFnZSBkYXRhJyk7XHJcbiAgICB9XHJcbiAgICBpbWFnZUdyYXBoaWNzLmNsZWFyUmVjdCgwLCAwLCBpbWFnZUNhbnZhcy53aWR0aCwgaW1hZ2VDYW52YXMuaGVpZ2h0KTtcclxuICAgIGltYWdlR3JhcGhpY3MuZHJhd0ltYWdlKGltYWdlLCAwLCAwKTtcclxuICAgIHJldHVybiBpbWFnZUdyYXBoaWNzLmdldEltYWdlRGF0YSgwLCAwLCBpbWFnZUNhbnZhcy53aWR0aCwgaW1hZ2VDYW52YXMuaGVpZ2h0KTtcclxufTtcclxuZXhwb3J0cy5nZXRJbWFnZURhdGEgPSBnZXRJbWFnZURhdGE7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuc3VidHJhY3Q0TXV0YXRlID0gdm9pZCAwO1xyXG5jb25zdCBzdWJ0cmFjdDRNdXRhdGUgPSAoYSwgYikgPT4ge1xyXG4gICAgYVswXSAtPSBiWzBdO1xyXG4gICAgYVsxXSAtPSBiWzFdO1xyXG4gICAgYVsyXSAtPSBiWzJdO1xyXG4gICAgYVszXSAtPSBiWzNdO1xyXG4gICAgcmV0dXJuIGE7XHJcbn07XHJcbmV4cG9ydHMuc3VidHJhY3Q0TXV0YXRlID0gc3VidHJhY3Q0TXV0YXRlO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmJ1aWxkU2hhZGVyU3RhZ2UgPSB2b2lkIDA7XHJcbmNvbnN0IGRlZmluZVNoYWRlclNuaXBwZXRfMSA9IHJlcXVpcmUoXCIuL2RlZmluZVNoYWRlclNuaXBwZXRcIik7XHJcbmNvbnN0IGJ1aWxkU2hhZGVyU3RhZ2UgPSAoc2hhZGVyLCB2ZXJzaW9uKSA9PiB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICBsZXQgdGVzdERlcGVuZGVuY2llcyA9IG5ldyBTZXQoc2hhZGVyLmRlcGVuZGVuY2llcyB8fCBbXSk7XHJcbiAgICBjb25zdCBhbGxEZXBlbmRlbmNpZXMgPSBuZXcgU2V0KHRlc3REZXBlbmRlbmNpZXMpO1xyXG4gICAgbGV0IG5leHRTZXQ7XHJcbiAgICBjb25zdCBhZGREZXBlbmRlbmNpZXMgPSAoZGVwZW5kZW5jaWVzKSA9PiB7XHJcbiAgICAgICAgaWYgKGRlcGVuZGVuY2llcykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHN1YmRlcGVuZGVuY3kgb2YgZGVwZW5kZW5jaWVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWxsRGVwZW5kZW5jaWVzLmhhcyhzdWJkZXBlbmRlbmN5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsbERlcGVuZGVuY2llcy5kZWxldGUoc3ViZGVwZW5kZW5jeSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0U2V0LmFkZChzdWJkZXBlbmRlbmN5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFsbERlcGVuZGVuY2llcy5hZGQoc3ViZGVwZW5kZW5jeSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgd2hpbGUgKHRlc3REZXBlbmRlbmNpZXMuc2l6ZSkge1xyXG4gICAgICAgIG5leHRTZXQgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgZm9yIChjb25zdCBkZXBlbmRlbmN5IG9mIHRlc3REZXBlbmRlbmNpZXMpIHtcclxuICAgICAgICAgICAgaWYgKCdzbmlwcGV0JyBpbiBkZXBlbmRlbmN5KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGRlcGVuZGVuY3k7XHJcbiAgICAgICAgICAgICAgICBhZGREZXBlbmRlbmNpZXMoaW5zdGFuY2Uuc25pcHBldC5kZXBlbmRlbmNpZXMpO1xyXG4gICAgICAgICAgICAgICAgYWRkRGVwZW5kZW5jaWVzKGluc3RhbmNlLnBhcmFtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYWRkRGVwZW5kZW5jaWVzKGRlcGVuZGVuY3kuZGVwZW5kZW5jaWVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGVzdERlcGVuZGVuY2llcyA9IG5leHRTZXQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBBcnJheS5mcm9tKGFsbERlcGVuZGVuY2llcy52YWx1ZXMoKSkucmV2ZXJzZSgpO1xyXG4gICAgcmV0dXJuIGAjdmVyc2lvbiAke3ZlcnNpb259XHJcblxyXG4gICAgICAgICR7KF9hID0gc2hhZGVyLmhlYWQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6ICcnfVxyXG5cclxuICAgICAgICAke2RlcGVuZGVuY2llcy5tYXAoZGVwZW5kZW5jeSA9PiB7XHJcbiAgICAgICAgY29uc3QgZGVwID0gZGVwZW5kZW5jeTtcclxuICAgICAgICBpZiAoJ3NuaXBwZXQnIGluIGRlcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmaW5lU2hhZGVyU25pcHBldF8xLmRlZmluZVNoYWRlclNuaXBwZXQoZGVwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZXAudGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9KS5qb2luKCdcXG4nKX1cclxuICAgIFxyXG4gICAgICAgIHZvaWQgbWFpbih2b2lkKSB7XHJcbiAgICAgICAgICAgICR7c2hhZGVyLm1haW59XHJcbiAgICAgICAgfVxyXG4gICAgYDtcclxufTtcclxuZXhwb3J0cy5idWlsZFNoYWRlclN0YWdlID0gYnVpbGRTaGFkZXJTdGFnZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5jcmVhdGVQcm9ncmFtID0gdm9pZCAwO1xyXG5jb25zdCBjcmVhdGVQcm9ncmFtID0gKGdsLCB2ZXJ0U2hhZGVyLCBmcmFnU2hhZGVyKSA9PiB7XHJcbiAgICBjb25zdCBwcm9ncmFtID0gZ2wuY3JlYXRlUHJvZ3JhbSgpO1xyXG4gICAgaWYgKHByb2dyYW0gPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBjcmVhdGUgcHJvZ3JhbScpO1xyXG4gICAgfVxyXG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHZlcnRTaGFkZXIpO1xyXG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGZyYWdTaGFkZXIpO1xyXG4gICAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7XHJcbiAgICBjb25zdCBsaW5rZWQgPSBnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIGdsLkxJTktfU1RBVFVTKTtcclxuICAgIGlmICghbGlua2VkKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZ2wuZ2V0UHJvZ3JhbUluZm9Mb2cocHJvZ3JhbSk7XHJcbiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGxpbmtpbmcgcHJvZ3JhbSA6ICR7ZXJyb3JNZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHByb2dyYW07XHJcbn07XHJcbmV4cG9ydHMuY3JlYXRlUHJvZ3JhbSA9IGNyZWF0ZVByb2dyYW07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXIgPSB2b2lkIDA7XHJcbmNvbnN0IGJ1aWxkU2hhZGVyU3RhZ2VfMSA9IHJlcXVpcmUoXCIuL2J1aWxkU2hhZGVyU3RhZ2VcIik7XHJcbmNvbnN0IGNyZWF0ZVByb2dyYW1fMSA9IHJlcXVpcmUoXCIuL2NyZWF0ZVByb2dyYW1cIik7XHJcbmNvbnN0IGxvYWRTaGFkZXJfMSA9IHJlcXVpcmUoXCIuL2xvYWRTaGFkZXJcIik7XHJcbmNvbnN0IGNyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyID0gKGdsLCBzaGFkZXIpID0+IHtcclxuICAgIGNvbnN0IHZlcnRTb3VyY2UgPSBidWlsZFNoYWRlclN0YWdlXzEuYnVpbGRTaGFkZXJTdGFnZShzaGFkZXIudmVydGV4LCBzaGFkZXIudmVyc2lvbik7XHJcbiAgICBjb25zdCBmcmFnU291cmNlID0gYnVpbGRTaGFkZXJTdGFnZV8xLmJ1aWxkU2hhZGVyU3RhZ2Uoc2hhZGVyLmZyYWdtZW50LCBzaGFkZXIudmVyc2lvbik7XHJcbiAgICBjb25zdCB2ZXJ0U2hhZGVyID0gbG9hZFNoYWRlcl8xLmxvYWRTaGFkZXIoZ2wsIHZlcnRTb3VyY2UsIGdsLlZFUlRFWF9TSEFERVIpO1xyXG4gICAgY29uc3QgZnJhZ1NoYWRlciA9IGxvYWRTaGFkZXJfMS5sb2FkU2hhZGVyKGdsLCBmcmFnU291cmNlLCBnbC5GUkFHTUVOVF9TSEFERVIpO1xyXG4gICAgcmV0dXJuIGNyZWF0ZVByb2dyYW1fMS5jcmVhdGVQcm9ncmFtKGdsLCB2ZXJ0U2hhZGVyLCBmcmFnU2hhZGVyKTtcclxufTtcclxuZXhwb3J0cy5jcmVhdGVQcm9ncmFtRnJvbVNoYWRlciA9IGNyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmRlZmluZVNoYWRlclNuaXBwZXQgPSB2b2lkIDA7XHJcbmNvbnN0IHNuaXBwZXRSZXN1bHRfMSA9IHJlcXVpcmUoXCIuL3NuaXBwZXRSZXN1bHRcIik7XHJcbmNvbnN0IGRlZmluZVNoYWRlclNuaXBwZXQgPSAoaW5zdGFuY2UpID0+IHtcclxuICAgIHZhciBfYSwgX2I7XHJcbiAgICBjb25zdCBmdW5jUGFyYW1zID0gW1xyXG4gICAgICAgIC4uLmluc3RhbmNlLnNuaXBwZXQucGFyYW1zLFxyXG4gICAgICAgIC4uLmluc3RhbmNlLnJlc3VsdE9ianMubWFwKHBhcmFtID0+IChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHBhcmFtKSwgeyBuYW1lOiBgJHtzbmlwcGV0UmVzdWx0XzEuc25pcHBldFJlc3VsdH0ke3BhcmFtLm5hbWV9YCB9KSkpXHJcbiAgICBdLm1hcChwYXJhbSA9PiBgJHtwYXJhbS5xdWFsaWZpZXJ9ICR7cGFyYW0udHlwZX0gJHtwYXJhbS5uYW1lfWApO1xyXG4gICAgcmV0dXJuIGAkeyhfYSA9IGluc3RhbmNlLnNuaXBwZXQucmV0dXJuVHlwZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogJ3ZvaWQnfSAke2luc3RhbmNlLm5hbWV9KCR7ZnVuY1BhcmFtcy5qb2luKCcsJyl9KSB7XHJcbiAgICAgICAgJHtpbnN0YW5jZS5zbmlwcGV0LnRleHQoLi4uKChfYiA9IGluc3RhbmNlLnBhcmFtcykgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogW10pKX1cclxuICAgIH1gO1xyXG59O1xyXG5leHBvcnRzLmRlZmluZVNoYWRlclNuaXBwZXQgPSBkZWZpbmVTaGFkZXJTbmlwcGV0O1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmxvYWRTaGFkZXIgPSB2b2lkIDA7XHJcbmNvbnN0IGxvYWRTaGFkZXIgPSAoZ2wsIHNvdXJjZSwgdHlwZSkgPT4ge1xyXG4gICAgY29uc3Qgc2hhZGVyID0gZ2wuY3JlYXRlU2hhZGVyKHR5cGUpO1xyXG4gICAgaWYgKHNoYWRlciA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGNyZWF0ZSBzaGFkZXInKTtcclxuICAgIH1cclxuICAgIGdsLnNoYWRlclNvdXJjZShzaGFkZXIsIHNvdXJjZSk7XHJcbiAgICBnbC5jb21waWxlU2hhZGVyKHNoYWRlcik7XHJcbiAgICBjb25zdCBjb21waWxlZCA9IGdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKTtcclxuICAgIGlmICghY29tcGlsZWQpIHtcclxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcik7XHJcbiAgICAgICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBjb21waWxpbmcgc2hhZGVyOiAke2Vycm9yTWVzc2FnZX1cXG4ke3NvdXJjZS5zcGxpdCgnXFxuJykubWFwKChzdHIsIGluZGV4KSA9PiBgJHtpbmRleCArIDF9OiR7c3RyfWApLmpvaW4oJ1xcbicpfWApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNoYWRlcjtcclxufTtcclxuZXhwb3J0cy5sb2FkU2hhZGVyID0gbG9hZFNoYWRlcjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5zbmlwcGV0UmVzdWx0ID0gdm9pZCAwO1xyXG5leHBvcnRzLnNuaXBwZXRSZXN1bHQgPSAnX3Jlc3VsdF8nO1xyXG4iXSwibmFtZXMiOlsiY3JlYXRlUmVuZGVyZXJfMSIsImNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbF8xIiwibWFrZUxvZ1NjYWxlXzEiLCJnZXRJbWFnZURhdGFfMSIsImNyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyXzEiLCJibHVyXzEiLCJnYW1lIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImltYWdlIiwiYW1vdW50SW5wdXQiLCJhbW91bnRWYWx1ZUlucHV0IiwidGltZXRha2VuIiwiZ2wiLCJnZXRDb250ZXh0IiwiRXJyb3IiLCJibHVyVW5pZm9ybUxvY2F0aW9uIiwiYmx1ckFtb3VudCIsInN0YXJ0IiwiYmx1ckxvZ1NjYWxlIiwibWFrZUxvZ1NjYWxlIiwiY2xlYXJDb2xvciIsInByb2dyYW0iLCJjcmVhdGVQcm9ncmFtRnJvbVNoYWRlciIsImJsdXIiLCJzY3JlZW5UcmlhbmdsZSIsImNyZWF0ZVZlcnRleEFycmF5IiwiYmluZFZlcnRleEFycmF5IiwicG9zaXRpb25CdWZmZXIiLCJjcmVhdGVCdWZmZXIiLCJiaW5kQnVmZmVyIiwiQVJSQVlfQlVGRkVSIiwiYnVmZmVyRGF0YSIsIkZsb2F0MzJBcnJheSIsIlNUQVRJQ19EUkFXIiwidGV4dHVyZSIsImNyZWF0ZVRleHR1cmUiLCJiaW5kVGV4dHVyZSIsIlRFWFRVUkVfMkQiLCJwaXhlbFN0b3JlaSIsIlVOUEFDS19GTElQX1lfV0VCR0wiLCJ0ZXhJbWFnZTJEIiwiUkdCQSIsIlVOU0lHTkVEX0JZVEUiLCJnZW5lcmF0ZU1pcG1hcCIsIndpZHRoIiwiaGVpZ2h0Iiwic3VtbWVkSW1hZ2UiLCJjcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2wiLCJnZXRJbWFnZURhdGEiLCJzdW1tZWRUZXh0dXJlIiwiUkdCQTMyVUkiLCJSR0JBX0lOVEVHRVIiLCJVTlNJR05FRF9JTlQiLCJ0ZXhQYXJhbWV0ZXJpIiwiVEVYVFVSRV9NQUdfRklMVEVSIiwiTkVBUkVTVCIsIlRFWFRVUkVfTUlOX0ZJTFRFUiIsIlRFWFRVUkVfV1JBUF9TIiwiQ0xBTVBfVE9fRURHRSIsIlRFWFRVUkVfV1JBUF9UIiwidXNlUHJvZ3JhbSIsInBvc2l0aW9uQXR0cmlidXRlTG9jYXRpb24iLCJnZXRBdHRyaWJMb2NhdGlvbiIsImVuYWJsZVZlcnRleEF0dHJpYkFycmF5IiwidmVydGV4QXR0cmliUG9pbnRlciIsIkZMT0FUIiwidGV4dHVyZVVuaWZvcm1Mb2NhdGlvbiIsImdldFVuaWZvcm1Mb2NhdGlvbiIsInVuaWZvcm0xaSIsImFjdGl2ZVRleHR1cmUiLCJURVhUVVJFMCIsInN1bW1lZFRleHR1cmVVbmlmb3JtTG9jYXRpb24iLCJURVhUVVJFMSIsImRyYXciLCJjcmVhdGVSZW5kZXJlciIsInZhbHVlIiwidG9TdHJpbmciLCJ0b0xpbmVhciIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJ2aWV3cG9ydCIsImNhbnZhcyIsImNsZWFyIiwiQ09MT1JfQlVGRkVSX0JJVCIsIkRFUFRIX0JVRkZFUl9CSVQiLCJ1bmlmb3JtMWYiLCJkcmF3QXJyYXlzIiwiVFJJQU5HTEVTIiwicmVhZFBpeGVscyIsIlVpbnQ4QXJyYXkiLCJpbm5lclRleHQiLCJyZW5kZXIiLCJvbmlucHV0IiwicGFyc2VGbG9hdCIsImZyb21MaW5lYXIiLCJ0b0ZpeGVkIiwib25jaGFuZ2UiLCJjb21wbGV0ZSIsIm9ubG9hZCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInJlbmRlckZ1bmMiLCJhZnRlclJlbmRlckZ1bmMiLCJkcmF3aW5nIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWRkNE11dGF0ZV8xIiwic3VidHJhY3Q0TXV0YXRlXzEiLCJpbWFnZURhdGEiLCJBcnJheSIsInkiLCJ4IiwiaSIsInBpeCIsIlVpbnQzMkFycmF5IiwiZGF0YSIsInNsaWNlIiwiYWRkNE11dGF0ZSIsInN1YnRyYWN0NE11dGF0ZSIsInN1bW1lZEltYWdlUmF3Iiwicm93IiwiZnJvbSIsInRvIiwibWluIiwiTWF0aCIsImxvZyIsInNjYWxlIiwiZXhwIiwibG9nVmFsdWUiLCJhdmVyYWdlU3VtbWVkXzEiLCJ2ZXJzaW9uIiwidmVydGV4IiwiaGVhZCIsIm1haW4iLCJmcmFnbWVudCIsImRlcGVuZGVuY2llcyIsImF2ZXJhZ2VTdW1tZWQiLCJnZXRQaXhlbF8xIiwiZ2V0U3VtbWVkQXJlYV8xIiwiZ2V0UGl4ZWwiLCJnZXRTdW1tZWRBcmVhIiwidGV4dCIsImEiLCJiIiwiaW1hZ2VDYW52YXMiLCJjcmVhdGVFbGVtZW50IiwiaW1hZ2VHcmFwaGljcyIsImNsZWFyUmVjdCIsImRyYXdJbWFnZSIsImJ1aWxkU2hhZGVyU3RhZ2UiLCJkZWZpbmVTaGFkZXJTbmlwcGV0XzEiLCJzaGFkZXIiLCJfYSIsInRlc3REZXBlbmRlbmNpZXMiLCJTZXQiLCJhbGxEZXBlbmRlbmNpZXMiLCJuZXh0U2V0IiwiYWRkRGVwZW5kZW5jaWVzIiwic3ViZGVwZW5kZW5jeSIsImhhcyIsImRlbGV0ZSIsImFkZCIsInNpemUiLCJkZXBlbmRlbmN5IiwiaW5zdGFuY2UiLCJzbmlwcGV0IiwicGFyYW1zIiwidmFsdWVzIiwicmV2ZXJzZSIsIm1hcCIsImRlcCIsImRlZmluZVNoYWRlclNuaXBwZXQiLCJqb2luIiwiY3JlYXRlUHJvZ3JhbSIsInZlcnRTaGFkZXIiLCJmcmFnU2hhZGVyIiwiYXR0YWNoU2hhZGVyIiwibGlua1Byb2dyYW0iLCJnZXRQcm9ncmFtUGFyYW1ldGVyIiwiTElOS19TVEFUVVMiLCJlcnJvck1lc3NhZ2UiLCJnZXRQcm9ncmFtSW5mb0xvZyIsImRlbGV0ZVByb2dyYW0iLCJidWlsZFNoYWRlclN0YWdlXzEiLCJjcmVhdGVQcm9ncmFtXzEiLCJsb2FkU2hhZGVyXzEiLCJ2ZXJ0U291cmNlIiwiZnJhZ1NvdXJjZSIsImxvYWRTaGFkZXIiLCJWRVJURVhfU0hBREVSIiwiRlJBR01FTlRfU0hBREVSIiwic25pcHBldFJlc3VsdF8xIiwiX2IiLCJmdW5jUGFyYW1zIiwicmVzdWx0T2JqcyIsInBhcmFtIiwiYXNzaWduIiwibmFtZSIsInNuaXBwZXRSZXN1bHQiLCJxdWFsaWZpZXIiLCJ0eXBlIiwicmV0dXJuVHlwZSIsInNvdXJjZSIsImNyZWF0ZVNoYWRlciIsInNoYWRlclNvdXJjZSIsImNvbXBpbGVTaGFkZXIiLCJnZXRTaGFkZXJQYXJhbWV0ZXIiLCJDT01QSUxFX1NUQVRVUyIsImdldFNoYWRlckluZm9Mb2ciLCJkZWxldGVTaGFkZXIiLCJzcGxpdCIsInN0ciIsImluZGV4Il0sInNvdXJjZVJvb3QiOiIifQ==