"use strict";(self.webpackChunksampling_coverage=self.webpackChunksampling_coverage||[]).push([[420],{851:(e,t,r)=>{const n=r(7787),o=r(3278),i=r(7601),a=r(8372),l=r(9864),u=r(5350),d=document.getElementById("game"),m=document.getElementById("image"),c=document.getElementById("amount"),s=document.getElementById("amountvalue"),x=document.getElementById("timetaken"),f=d.getContext("webgl2");if(!f)throw new Error("No WebGL2 Support :(");let v,g=8;const p=()=>{const e=(0,i.makeLogScale)(0,512);f.clearColor(0,0,0,0);const t=(0,l.createProgramFromShader)(f,u.blur),r=f.createVertexArray();if(null===r)throw new Error("Could not create screen triangle");f.bindVertexArray(r);const d=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,d),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),f.STATIC_DRAW);const p=f.createTexture();if(f.bindTexture(f.TEXTURE_2D,p),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,m),f.generateMipmap(f.TEXTURE_2D),m.width*m.height>16777216)throw new Error("Image too big, up to 4096 x 4096 supported");const h=(0,o.createSummedTextureWebgl)((0,a.getImageData)(m)),_=f.createTexture();f.bindTexture(f.TEXTURE_2D,_),f.texImage2D(f.TEXTURE_2D,0,f.RGBA32UI,m.width,m.height,0,f.RGBA_INTEGER,f.UNSIGNED_INT,h),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.useProgram(t);const C=f.getAttribLocation(t,"a_position");f.bindBuffer(f.ARRAY_BUFFER,d),f.enableVertexAttribArray(C),f.vertexAttribPointer(C,2,f.FLOAT,!1,0,0);const T=f.getUniformLocation(t,"u_texture");f.uniform1i(T,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,p),v=f.getUniformLocation(t,"u_bluramount");const E=f.getUniformLocation(t,"u_summedtexture");f.uniform1i(E,1),f.activeTexture(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,_);const y=(0,n.createRenderer)((()=>{s.value=g.toString(),c.value=e.toLinear(g).toString(),((e,t)=>{const r=Date.now();f.viewport(0,0,f.canvas.width,f.canvas.height),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),f.useProgram(e),f.uniform1f(v,g),f.bindVertexArray(t),f.drawArrays(f.TRIANGLES,0,3),f.readPixels(0,0,1,1,f.RGBA,f.UNSIGNED_BYTE,new Uint8Array(4)),x.innerText=Date.now()-r+" ms"})(t,r)}));c.oninput=()=>{g=parseFloat(e.fromLinear(parseFloat(c.value)).toFixed(1)),y()},s.onchange=()=>{g=parseFloat(s.value),y()},y()};m.complete?p():m.onload=p},7787:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderer=void 0,t.createRenderer=(e,t)=>{let r=!1;return()=>{r||(r=!0,requestAnimationFrame((()=>{e(),r=!1,null==t||t()})))}}},3278:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSummedTextureWebgl=void 0;const n=r(9078),o=r(6196);t.createSummedTextureWebgl=e=>{const t=new Array(e.height);for(let r=0;r<e.height;r++){t[r]=new Array(e.width);for(let i=0;i<e.width;i++){const a=4*((e.height-1-r)*e.width+i),l=new Uint32Array(e.data.slice(a,a+4));i>0&&(0,n.add4Mutate)(l,t[r][i-1]),r>0&&(0,n.add4Mutate)(l,t[r-1][i]),i>0&&r>0&&(0,o.subtract4Mutate)(l,t[r-1][i-1]),t[r][i]=l}}const r=new Uint32Array(e.width*e.height*4);for(let n=0,o=e.height-1;o>=0;o--){const i=t[o];for(let t=0;t<e.width;t++,n+=4){const e=i[t];r[n]=e[0],r[n+1]=e[1],r[n+2]=e[2],r[n+3]=e[3]}}return r}},7601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeLogScale=void 0,t.makeLogScale=(e,t)=>{const r=e?Math.log(e):0,n=Math.log(t)-r;return{fromLinear:e=>Math.exp(r+n*e),toLinear:e=>(Math.log(e)-r)/n}}},5350:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blur=void 0;const n=r(8053);t.blur={version:"300 es",vertex:{head:"\n            in vec2 a_position;\n        ",main:"\n            gl_Position = vec4(a_position, 0.0, 1.0);\n        "},fragment:{dependencies:[n.averageSummed],head:"\n            precision highp float;\n            precision highp usampler2D;\n\n            uniform float u_bluramount;\n            uniform sampler2D u_texture;\n            uniform usampler2D u_summedtexture;\n\n            out vec4 outColor;\n        ",main:"\n            ivec2 fragCoord = ivec2(gl_FragCoord.xy);\n            vec2 tex_size = vec2(textureSize(u_summedtexture, 0));\n\n            vec2 minCoord = clamp(vec2(fragCoord) - u_bluramount, vec2(0.0), tex_size);\n            vec2 maxCoord = clamp(vec2(fragCoord) + u_bluramount, vec2(0.0), tex_size);\n\n            vec4 pixelColour = averageSummed(u_summedtexture, u_texture, minCoord, maxCoord);\n\n            outColor = pixelColour / 255.0;\n        "}}},8053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.averageSummed=void 0;const n=r(4768),o=r(967);t.averageSummed={dependencies:[n.getPixel,o.getSummedArea],text:"\n        //results in up to 24 texture lookups based on complexity of range, whatever size the image is\n        vec4 averageSummed(const in usampler2D summedTexture, const in sampler2D texture, const in vec2 minCoord, const in vec2 maxCoord) {\n            ivec2 startCell = ivec2(floor(minCoord));\n            ivec2 endCell = ivec2(floor(maxCoord));\n\n            //range contained in one pixel\n            if (startCell == endCell) {\n                return texelFetch(texture, ivec2(startCell), 0);\n            }\n            \n            vec2 size = maxCoord - minCoord;\n            float pixelArea = size.x * size.y;\n            float colourNormaliser = 1.0 / pixelArea;\n            \n            ivec2 innerCell = ivec2(ceil(minCoord));\n            ivec2 innerCell2 = ivec2(floor(maxCoord));\n\n            vec2 minDiff = vec2(innerCell) - minCoord;\n            vec2 maxDiff = maxCoord - vec2(innerCell2);\n\n            vec4 colour = vec4(0.0);\n\n            //TODO: optimise by removing branches\n            \n            //single horizontal strip\n            if (startCell.x == endCell.x) {\n                if (minDiff.y > 0.0) {\n                    colour += getPixel(texture, startCell) * size.x * minDiff.y;\n                }\n\n                if (maxDiff.y > 0.0) {\n                    colour += getPixel(texture, endCell) * size.x * maxDiff.y;\n                }\n\n                colour += getSummedArea(summedTexture, ivec2(startCell.x, innerCell.y)-1, ivec2(startCell.x, innerCell2.y-1)) * size.x;\n                return floor(colour * colourNormaliser);\n            }\n            \n            //single vertical strip\n            if (startCell.y == endCell.y) {\n                if (minDiff.x > 0.0) {\n                    colour += getPixel(texture, startCell) * size.y * minDiff.x;\n                }\n\n                if (maxDiff.x > 0.0) {\n                    colour += getPixel(texture, endCell) * size.y * maxDiff.x;\n                }\n\n                colour += getSummedArea(summedTexture, ivec2(innerCell.x, startCell.y)-1, ivec2(innerCell2.x-1, startCell.y)) * size.y;\n                return floor(colour * colourNormaliser);\n            }\n\n            //corner cells\n            if (minDiff.y > 0.0) {\n                if (minDiff.x > 0.0) {\n                    colour += getPixel(texture, startCell) * minDiff.x * minDiff.y;\n                }\n\n                if (maxDiff.x > 0.0) {\n                    colour += getPixel(texture, ivec2(endCell.x, startCell.y)) * maxDiff.x * minDiff.y;\n                }\n            }\n\n            if (maxDiff.y > 0.0) {\n                if (minDiff.x > 0.0) {\n                    colour += getPixel(texture, ivec2(startCell.x, endCell.y)) * minDiff.x * maxDiff.y;\n                }\n\n                if (maxDiff.x > 0.0) {\n                    colour += getPixel(texture, endCell) * maxDiff.x * maxDiff.y;\n                }\n            }\n\n            //fractional strips\n            if (minDiff.y > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(innerCell.x, startCell.y)-1, ivec2(innerCell2.x-1, startCell.y)) * minDiff.y;\n            }\n\n            if (minDiff.x > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(startCell.x, innerCell.y)-1, ivec2(startCell.x, innerCell2.y-1)) * minDiff.x;\n            }\n\n            if (maxDiff.y > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(innerCell.x, endCell.y)-1, ivec2(innerCell2.x-1, endCell.y)) * maxDiff.y;\n            }\n\n            if (maxDiff.x > 0.0) {\n                colour += getSummedArea(summedTexture, ivec2(endCell.x, innerCell.y)-1, ivec2(endCell.x, innerCell2.y-1)) * maxDiff.x;\n            }\n\n            //inner parts\n            colour += getSummedArea(summedTexture, ivec2(innerCell)-1, ivec2(innerCell2)-1);\n            \n            //now we have an accumulative pixel value that covers the whole area so just average it\n            return floor(colour * colourNormaliser);\n        }\n    "}},4768:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPixel=void 0,t.getPixel={text:"\n        vec4 getPixel(const in sampler2D texture, const in ivec2 pos) {\n            return texelFetch(texture, pos, 0) * 255.0;\n        }\n    "}},967:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSummedArea=void 0,t.getSummedArea={text:"\n        vec4 getSummedArea(const in usampler2D summedTexture, const in ivec2 minCoord, const in ivec2 maxCoord) {\n            return vec4(texelFetch(summedTexture, maxCoord, 0) - \n                texelFetch(summedTexture, ivec2(minCoord.x, maxCoord.y), 0) + \n                texelFetch(summedTexture, minCoord, 0) -\n                texelFetch(summedTexture, ivec2(maxCoord.x, minCoord.y), 0));\n        }\n    "}},9078:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.add4Mutate=void 0,t.add4Mutate=(e,t)=>(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e)},8372:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImageData=void 0,t.getImageData=e=>{const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");if(!r)throw new Error("Could not create canvas to extract image data");return r.clearRect(0,0,t.width,t.height),r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}},6196:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subtract4Mutate=void 0,t.subtract4Mutate=(e,t)=>(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e[3]-=t[3],e)},5498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildShaderStage=void 0;const n=r(5941);t.buildShaderStage=(e,t)=>{var r;let o=new Set(e.dependencies||[]);const i=new Set(o);let a;const l=e=>{if(e)for(const t of e)i.has(t)?i.delete(t):a.add(t),i.add(t)};for(;o.size;){a=new Set;for(const e of o){if("snippet"in e){const t=e;l(t.snippet.dependencies),l(t.params)}l(e.dependencies)}o=a}const u=Array.from(i.values()).reverse();return`#version ${t}\n\n        ${null!==(r=e.head)&&void 0!==r?r:""}\n\n        ${u.map((e=>{const t=e;return"snippet"in t?(0,n.defineShaderSnippet)(t):t.text})).join("\n")}\n    \n        void main(void) {\n            ${e.main}\n        }\n    `}},3795:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProgram=void 0,t.createProgram=(e,t,r)=>{const n=e.createProgram();if(null===n)throw new Error("Could not create program");if(e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){const t=e.getProgramInfoLog(n);throw e.deleteProgram(n),new Error(`Error linking program : ${t}`)}return n}},9864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProgramFromShader=void 0;const n=r(5498),o=r(3795),i=r(5549);t.createProgramFromShader=(e,t)=>{const r=(0,n.buildShaderStage)(t.vertex,t.version),a=(0,n.buildShaderStage)(t.fragment,t.version),l=(0,i.loadShader)(e,r,e.VERTEX_SHADER),u=(0,i.loadShader)(e,a,e.FRAGMENT_SHADER);return(0,o.createProgram)(e,l,u)}},5941:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defineShaderSnippet=void 0;const n=r(2072);t.defineShaderSnippet=e=>{var t,r;const o=[...e.snippet.params,...e.resultObjs.map((e=>Object.assign(Object.assign({},e),{name:`${n.snippetResult}${e.name}`})))].map((e=>`${e.qualifier} ${e.type} ${e.name}`));return`${null!==(t=e.snippet.returnType)&&void 0!==t?t:"void"} ${e.name}(${o.join(",")}) {\n        ${e.snippet.text(...null!==(r=e.params)&&void 0!==r?r:[])}\n    }`}},5549:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadShader=void 0,t.loadShader=(e,t,r)=>{const n=e.createShader(r);if(null===n)throw new Error("Could not create shader");if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const r=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error(`Error compiling shader: ${r}\n${t.split("\n").map(((e,t)=>`${t+1}:${e}`)).join("\n")}`)}return n}},2072:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.snippetResult=void 0,t.snippetResult="_result_"}},e=>{e(e.s=851)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUssU0FFZCxPQUFPckIsSSxhQ2xCWHBELE9BQU9DLGVBQWVDLEVBQVMsYUFBYyxDQUFFM0IsT0FBTyxJQUN0RDJCLEVBQVFpRyxtQkFBZ0IsRUFDeEJqRyxFQUFRaUcsY0FBZ0IsYSIsInNvdXJjZXMiOlsid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL2RlbW9zL2Zhc3RCbHVyV2ViZ2wudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvZHJhdy9jcmVhdGVSZW5kZXJlci50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy9kcmF3L2NyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbC50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy9tYXRocy9tYWtlTG9nU2NhbGUudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvc2hhZGVycy9ibHVyLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3NoYWRlcnMvc3VtbWluZy9hdmVyYWdlU3VtbWVkLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3NoYWRlcnMvc3VtbWluZy9nZXRQaXhlbC50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy9zaGFkZXJzL3N1bW1pbmcvZ2V0U3VtbWVkQXJlYS50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy91dGlscy9hZGQ0TXV0YXRlLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3V0aWxzL2dldEltYWdlRGF0YS50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy91dGlscy9zdWJ0cmFjdDRNdXRhdGUudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvd2ViZ2wvYnVpbGRTaGFkZXJTdGFnZS50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy93ZWJnbC9jcmVhdGVQcm9ncmFtLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3dlYmdsL2NyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyLnRzIiwid2VicGFjazovL3NhbXBsaW5nLWNvdmVyYWdlLy4vc3JjL3dlYmdsL2RlZmluZVNoYWRlclNuaXBwZXQudHMiLCJ3ZWJwYWNrOi8vc2FtcGxpbmctY292ZXJhZ2UvLi9zcmMvd2ViZ2wvbG9hZFNoYWRlci50cyIsIndlYnBhY2s6Ly9zYW1wbGluZy1jb3ZlcmFnZS8uL3NyYy93ZWJnbC9zbmlwcGV0UmVzdWx0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IGNyZWF0ZVJlbmRlcmVyXzEgPSByZXF1aXJlKFwiLi4vZHJhdy9jcmVhdGVSZW5kZXJlclwiKTtcclxuY29uc3QgY3JlYXRlU3VtbWVkVGV4dHVyZVdlYmdsXzEgPSByZXF1aXJlKFwiLi4vZHJhdy9jcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2xcIik7XHJcbmNvbnN0IG1ha2VMb2dTY2FsZV8xID0gcmVxdWlyZShcIi4uL21hdGhzL21ha2VMb2dTY2FsZVwiKTtcclxuY29uc3QgZ2V0SW1hZ2VEYXRhXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvZ2V0SW1hZ2VEYXRhXCIpO1xyXG5jb25zdCBjcmVhdGVQcm9ncmFtRnJvbVNoYWRlcl8xID0gcmVxdWlyZShcIi4uL3dlYmdsL2NyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyXCIpO1xyXG5jb25zdCBibHVyXzEgPSByZXF1aXJlKFwiLi4vc2hhZGVycy9ibHVyXCIpO1xyXG5jb25zdCBnYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUnKTtcclxuY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hZ2UnKTtcclxuY29uc3QgYW1vdW50SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW1vdW50Jyk7XHJcbmNvbnN0IGFtb3VudFZhbHVlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW1vdW50dmFsdWUnKTtcclxuY29uc3QgdGltZXRha2VuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWV0YWtlbicpO1xyXG4vL25lZWQgdG8gdXNlIHdlYmdsIDIgdG8gYmUgYWJsZSB0byBjcmVhdGUgYSBzdWl0YWJsZSBzdW1tZWQgdGV4dHVyZSB3aXRob3V0IGNvbXByZXNzaW9uXHJcbmNvbnN0IGdsID0gZ2FtZS5nZXRDb250ZXh0KCd3ZWJnbDInKTtcclxuaWYgKCFnbCkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdObyBXZWJHTDIgU3VwcG9ydCA6KCcpO1xyXG59XHJcbmxldCBibHVyQW1vdW50ID0gODtcclxubGV0IGJsdXJVbmlmb3JtTG9jYXRpb247XHJcbmNvbnN0IHJlbmRlciA9IChwcm9ncmFtLCBzY3JlZW5UcmlhbmdsZSkgPT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGdsLnZpZXdwb3J0KDAsIDAsIGdsLmNhbnZhcy53aWR0aCwgZ2wuY2FudmFzLmhlaWdodCk7XHJcbiAgICBnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUIHwgZ2wuREVQVEhfQlVGRkVSX0JJVCk7XHJcbiAgICAvL2RyYXcgb3VyIHNpbmdsZSB0cmlhbmdsZVxyXG4gICAgZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgIGdsLnVuaWZvcm0xZihibHVyVW5pZm9ybUxvY2F0aW9uLCBibHVyQW1vdW50KTtcclxuICAgIGdsLmJpbmRWZXJ0ZXhBcnJheShzY3JlZW5UcmlhbmdsZSk7XHJcbiAgICBnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFUywgMCwgMyk7XHJcbiAgICBnbC5yZWFkUGl4ZWxzKDAsIDAsIDEsIDEsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsIG5ldyBVaW50OEFycmF5KDQpKTtcclxuICAgIHRpbWV0YWtlbi5pbm5lclRleHQgPSBgJHtEYXRlLm5vdygpIC0gc3RhcnRUaW1lfSBtc2A7XHJcbn07XHJcbmNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xyXG4gICAgY29uc3QgYmx1ckxvZ1NjYWxlID0gKDAsIG1ha2VMb2dTY2FsZV8xLm1ha2VMb2dTY2FsZSkoMCwgNTEyKTtcclxuICAgIGdsLmNsZWFyQ29sb3IoMCwgMCwgMCwgMCk7XHJcbiAgICBjb25zdCBwcm9ncmFtID0gKDAsIGNyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyXzEuY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXIpKGdsLCBibHVyXzEuYmx1cik7XHJcbiAgICAvL2J1ZmZlcnNcclxuICAgIGNvbnN0IHNjcmVlblRyaWFuZ2xlID0gZ2wuY3JlYXRlVmVydGV4QXJyYXkoKTtcclxuICAgIGlmIChzY3JlZW5UcmlhbmdsZSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGNyZWF0ZSBzY3JlZW4gdHJpYW5nbGUnKTtcclxuICAgIH1cclxuICAgIGdsLmJpbmRWZXJ0ZXhBcnJheShzY3JlZW5UcmlhbmdsZSk7XHJcbiAgICBjb25zdCBwb3NpdGlvbkJ1ZmZlciA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHBvc2l0aW9uQnVmZmVyKTtcclxuICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBuZXcgRmxvYXQzMkFycmF5KFstMSwgLTEsIDMsIC0xLCAtMSwgM10pLCBnbC5TVEFUSUNfRFJBVyk7XHJcbiAgICAvLyAtIG9yaWdpbmFsIHRleHR1cmVcclxuICAgIGNvbnN0IHRleHR1cmUgPSBnbC5jcmVhdGVUZXh0dXJlKCk7XHJcbiAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCB0ZXh0dXJlKTtcclxuICAgIGdsLnBpeGVsU3RvcmVpKGdsLlVOUEFDS19GTElQX1lfV0VCR0wsIHRydWUpO1xyXG4gICAgZ2wudGV4SW1hZ2UyRChnbC5URVhUVVJFXzJELCAwLCBnbC5SR0JBLCBnbC5SR0JBLCBnbC5VTlNJR05FRF9CWVRFLCBpbWFnZSk7XHJcbiAgICBnbC5nZW5lcmF0ZU1pcG1hcChnbC5URVhUVVJFXzJEKTtcclxuICAgIC8vIC0gc3VtbWVkIHRleHR1cmVcclxuICAgIC8vIGZsYXR0ZW4gdGhlIHByb2R1Y2VkIHN1bW1lZCBpbWFnZSBzbyBpdCBpcyBzdWl0YWJsZSBmb3IgY3JlYXRpbmcgYSB0ZXh0dXJlIG91dCBvZiBpdFxyXG4gICAgLy8gb25jZSB3ZSBoYXZlIGdlbmVyYXRlZCBvdXIgc3VtbW1lZCB0ZXh0dXJlIHdlIGNhbiBwYXNzIGl0IHRvIG91ciBzaGFkZXJzIHVzaW5nIFJHQkEzMlVJIGZvcm1hdCAoNCBieXRlIHVuc2lnbmVkIGludCBwZXIgY2hhbm5lbClcclxuICAgIC8vIHRoaXMgbWVhbnMgdGhlIHN1bW1lZCB0ZXh0dXJlIGNhbiBzdXBwb3J0IHN1bW1pbmcgZm9yIHRleHR1cmVzIG9mIHVwIHRvIDQwOTYgeCA0MDk2IChwbGVudHkpXHJcbiAgICBjb25zdCBtYXhQaXhlbHMgPSA0MDk2ICogNDA5NjtcclxuICAgIGlmIChpbWFnZS53aWR0aCAqIGltYWdlLmhlaWdodCA+IG1heFBpeGVscykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW1hZ2UgdG9vIGJpZywgdXAgdG8gNDA5NiB4IDQwOTYgc3VwcG9ydGVkJyk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBzdW1tZWRJbWFnZSA9ICgwLCBjcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2xfMS5jcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2wpKCgwLCBnZXRJbWFnZURhdGFfMS5nZXRJbWFnZURhdGEpKGltYWdlKSk7XHJcbiAgICBjb25zdCBzdW1tZWRUZXh0dXJlID0gZ2wuY3JlYXRlVGV4dHVyZSgpO1xyXG4gICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgc3VtbWVkVGV4dHVyZSk7XHJcbiAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEzMlVJLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LCAwLCBnbC5SR0JBX0lOVEVHRVIsIGdsLlVOU0lHTkVEX0lOVCwgc3VtbWVkSW1hZ2UpO1xyXG4gICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01BR19GSUxURVIsIGdsLk5FQVJFU1QpO1xyXG4gICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01JTl9GSUxURVIsIGdsLk5FQVJFU1QpO1xyXG4gICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX1dSQVBfUywgZ2wuQ0xBTVBfVE9fRURHRSk7XHJcbiAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9ULCBnbC5DTEFNUF9UT19FREdFKTtcclxuICAgIC8vYmluZCBidWZmZXJzIHRvIHNoYWRlclxyXG4gICAgZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgIGNvbnN0IHBvc2l0aW9uQXR0cmlidXRlTG9jYXRpb24gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAnYV9wb3NpdGlvbicpO1xyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHBvc2l0aW9uQnVmZmVyKTtcclxuICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHBvc2l0aW9uQXR0cmlidXRlTG9jYXRpb24pO1xyXG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihwb3NpdGlvbkF0dHJpYnV0ZUxvY2F0aW9uLCAyLCBnbC5GTE9BVCwgZmFsc2UsIDAsIDApO1xyXG4gICAgY29uc3QgdGV4dHVyZVVuaWZvcm1Mb2NhdGlvbiA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAndV90ZXh0dXJlJyk7XHJcbiAgICBnbC51bmlmb3JtMWkodGV4dHVyZVVuaWZvcm1Mb2NhdGlvbiwgMCk7XHJcbiAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwKTtcclxuICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRleHR1cmUpO1xyXG4gICAgYmx1clVuaWZvcm1Mb2NhdGlvbiA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAndV9ibHVyYW1vdW50Jyk7XHJcbiAgICBjb25zdCBzdW1tZWRUZXh0dXJlVW5pZm9ybUxvY2F0aW9uID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sICd1X3N1bW1lZHRleHR1cmUnKTtcclxuICAgIGdsLnVuaWZvcm0xaShzdW1tZWRUZXh0dXJlVW5pZm9ybUxvY2F0aW9uLCAxKTtcclxuICAgIGdsLmFjdGl2ZVRleHR1cmUoZ2wuVEVYVFVSRTEpO1xyXG4gICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgc3VtbWVkVGV4dHVyZSk7XHJcbiAgICAvL2lucHV0c1xyXG4gICAgY29uc3QgZHJhdyA9ICgwLCBjcmVhdGVSZW5kZXJlcl8xLmNyZWF0ZVJlbmRlcmVyKSgoKSA9PiB7XHJcbiAgICAgICAgYW1vdW50VmFsdWVJbnB1dC52YWx1ZSA9IGJsdXJBbW91bnQudG9TdHJpbmcoKTtcclxuICAgICAgICBhbW91bnRJbnB1dC52YWx1ZSA9IGJsdXJMb2dTY2FsZS50b0xpbmVhcihibHVyQW1vdW50KS50b1N0cmluZygpO1xyXG4gICAgICAgIHJlbmRlcihwcm9ncmFtLCBzY3JlZW5UcmlhbmdsZSk7XHJcbiAgICB9KTtcclxuICAgIGFtb3VudElucHV0Lm9uaW5wdXQgPSAoKSA9PiB7XHJcbiAgICAgICAgLy9jb252ZXJ0IHRoZSBzbGlkZXIgdmFsdWUgYXMgaWYgaXQgd2FzIGV4cG9uZW50aWFsXHJcbiAgICAgICAgYmx1ckFtb3VudCA9IHBhcnNlRmxvYXQoYmx1ckxvZ1NjYWxlLmZyb21MaW5lYXIocGFyc2VGbG9hdChhbW91bnRJbnB1dC52YWx1ZSkpLnRvRml4ZWQoMSkpO1xyXG4gICAgICAgIGRyYXcoKTtcclxuICAgIH07XHJcbiAgICBhbW91bnRWYWx1ZUlucHV0Lm9uY2hhbmdlID0gKCkgPT4ge1xyXG4gICAgICAgIGJsdXJBbW91bnQgPSBwYXJzZUZsb2F0KGFtb3VudFZhbHVlSW5wdXQudmFsdWUpO1xyXG4gICAgICAgIGRyYXcoKTtcclxuICAgIH07XHJcbiAgICBkcmF3KCk7XHJcbn07XHJcbmlmIChpbWFnZS5jb21wbGV0ZSkge1xyXG4gICAgc3RhcnQoKTtcclxufVxyXG5lbHNlIHtcclxuICAgIGltYWdlLm9ubG9hZCA9IHN0YXJ0O1xyXG59XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuY3JlYXRlUmVuZGVyZXIgPSB2b2lkIDA7XHJcbmNvbnN0IGNyZWF0ZVJlbmRlcmVyID0gKHJlbmRlckZ1bmMsIGFmdGVyUmVuZGVyRnVuYykgPT4ge1xyXG4gICAgbGV0IGRyYXdpbmcgPSBmYWxzZTtcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFkcmF3aW5nKSB7XHJcbiAgICAgICAgICAgIGRyYXdpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyRnVuYygpO1xyXG4gICAgICAgICAgICAgICAgZHJhd2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgYWZ0ZXJSZW5kZXJGdW5jID09PSBudWxsIHx8IGFmdGVyUmVuZGVyRnVuYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWZ0ZXJSZW5kZXJGdW5jKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XHJcbmV4cG9ydHMuY3JlYXRlUmVuZGVyZXIgPSBjcmVhdGVSZW5kZXJlcjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5jcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2wgPSB2b2lkIDA7XHJcbmNvbnN0IGFkZDRNdXRhdGVfMSA9IHJlcXVpcmUoXCIuLi91dGlscy9hZGQ0TXV0YXRlXCIpO1xyXG5jb25zdCBzdWJ0cmFjdDRNdXRhdGVfMSA9IHJlcXVpcmUoXCIuLi91dGlscy9zdWJ0cmFjdDRNdXRhdGVcIik7XHJcbi8vc2ltaWxhciB0byBjcmVhdGVTdW1tZWRUZXh0dXJlIGV4Y2VwdCBjcmVhdGVzIGEgc2luZ2xlIHVpbnQzMiBhcnJheSBhbmQgZmxpcHMgdGhlIHkgb2YgdGhlIGltYWdlXHJcbmNvbnN0IGNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbCA9IChpbWFnZURhdGEpID0+IHtcclxuICAgIGNvbnN0IHN1bW1lZFRleHR1cmUgPSBuZXcgQXJyYXkoaW1hZ2VEYXRhLmhlaWdodCk7XHJcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IGltYWdlRGF0YS5oZWlnaHQ7IHkrKykge1xyXG4gICAgICAgIHN1bW1lZFRleHR1cmVbeV0gPSBuZXcgQXJyYXkoaW1hZ2VEYXRhLndpZHRoKTtcclxuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IGltYWdlRGF0YS53aWR0aDsgeCsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSAoKGltYWdlRGF0YS5oZWlnaHQgLSAxIC0geSkgKiBpbWFnZURhdGEud2lkdGggKyB4KSAqIDQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHBpeCA9IG5ldyBVaW50MzJBcnJheShpbWFnZURhdGEuZGF0YS5zbGljZShpLCBpICsgNCkpO1xyXG4gICAgICAgICAgICBpZiAoeCA+IDApIHtcclxuICAgICAgICAgICAgICAgICgwLCBhZGQ0TXV0YXRlXzEuYWRkNE11dGF0ZSkocGl4LCBzdW1tZWRUZXh0dXJlW3ldW3ggLSAxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAoMCwgYWRkNE11dGF0ZV8xLmFkZDRNdXRhdGUpKHBpeCwgc3VtbWVkVGV4dHVyZVt5IC0gMV1beF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh4ID4gMCAmJiB5ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgKDAsIHN1YnRyYWN0NE11dGF0ZV8xLnN1YnRyYWN0NE11dGF0ZSkocGl4LCBzdW1tZWRUZXh0dXJlW3kgLSAxXVt4IC0gMV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN1bW1lZFRleHR1cmVbeV1beF0gPSBwaXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3Qgc3VtbWVkSW1hZ2VSYXcgPSBuZXcgVWludDMyQXJyYXkoaW1hZ2VEYXRhLndpZHRoICogaW1hZ2VEYXRhLmhlaWdodCAqIDQpO1xyXG4gICAgZm9yIChsZXQgaSA9IDAsIHkgPSBpbWFnZURhdGEuaGVpZ2h0IC0gMTsgeSA+PSAwOyB5LS0pIHtcclxuICAgICAgICBjb25zdCByb3cgPSBzdW1tZWRUZXh0dXJlW3ldO1xyXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgaW1hZ2VEYXRhLndpZHRoOyB4KyssIGkgKz0gNCkge1xyXG4gICAgICAgICAgICBjb25zdCBwaXggPSByb3dbeF07XHJcbiAgICAgICAgICAgIHN1bW1lZEltYWdlUmF3W2ldID0gcGl4WzBdO1xyXG4gICAgICAgICAgICBzdW1tZWRJbWFnZVJhd1tpICsgMV0gPSBwaXhbMV07XHJcbiAgICAgICAgICAgIHN1bW1lZEltYWdlUmF3W2kgKyAyXSA9IHBpeFsyXTtcclxuICAgICAgICAgICAgc3VtbWVkSW1hZ2VSYXdbaSArIDNdID0gcGl4WzNdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzdW1tZWRJbWFnZVJhdztcclxufTtcclxuZXhwb3J0cy5jcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2wgPSBjcmVhdGVTdW1tZWRUZXh0dXJlV2ViZ2w7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMubWFrZUxvZ1NjYWxlID0gdm9pZCAwO1xyXG5jb25zdCBtYWtlTG9nU2NhbGUgPSAoZnJvbSwgdG8pID0+IHtcclxuICAgIGNvbnN0IG1pbiA9IGZyb20gPyBNYXRoLmxvZyhmcm9tKSA6IDA7XHJcbiAgICBjb25zdCBtYXggPSBNYXRoLmxvZyh0byk7XHJcbiAgICBjb25zdCBzY2FsZSA9IG1heCAtIG1pbjtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZnJvbUxpbmVhcjogKHZhbHVlKSA9PiBNYXRoLmV4cChtaW4gKyBzY2FsZSAqIHZhbHVlKSxcclxuICAgICAgICB0b0xpbmVhcjogKGxvZ1ZhbHVlKSA9PiAoTWF0aC5sb2cobG9nVmFsdWUpIC0gbWluKSAvIHNjYWxlXHJcbiAgICB9O1xyXG59O1xyXG5leHBvcnRzLm1ha2VMb2dTY2FsZSA9IG1ha2VMb2dTY2FsZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5ibHVyID0gdm9pZCAwO1xyXG5jb25zdCBhdmVyYWdlU3VtbWVkXzEgPSByZXF1aXJlKFwiLi9zdW1taW5nL2F2ZXJhZ2VTdW1tZWRcIik7XHJcbmV4cG9ydHMuYmx1ciA9IHtcclxuICAgIHZlcnNpb246ICczMDAgZXMnLFxyXG4gICAgdmVydGV4OiB7XHJcbiAgICAgICAgaGVhZDogLyogZ2xzbCAqLyBgXHJcbiAgICAgICAgICAgIGluIHZlYzIgYV9wb3NpdGlvbjtcclxuICAgICAgICBgLFxyXG4gICAgICAgIG1haW46IC8qIGdsc2wgKi8gYFxyXG4gICAgICAgICAgICBnbF9Qb3NpdGlvbiA9IHZlYzQoYV9wb3NpdGlvbiwgMC4wLCAxLjApO1xyXG4gICAgICAgIGBcclxuICAgIH0sXHJcbiAgICBmcmFnbWVudDoge1xyXG4gICAgICAgIGRlcGVuZGVuY2llczogW2F2ZXJhZ2VTdW1tZWRfMS5hdmVyYWdlU3VtbWVkXSxcclxuICAgICAgICBoZWFkOiAvKiBnbHNsICovIGBcclxuICAgICAgICAgICAgcHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xyXG4gICAgICAgICAgICBwcmVjaXNpb24gaGlnaHAgdXNhbXBsZXIyRDtcclxuXHJcbiAgICAgICAgICAgIHVuaWZvcm0gZmxvYXQgdV9ibHVyYW1vdW50O1xyXG4gICAgICAgICAgICB1bmlmb3JtIHNhbXBsZXIyRCB1X3RleHR1cmU7XHJcbiAgICAgICAgICAgIHVuaWZvcm0gdXNhbXBsZXIyRCB1X3N1bW1lZHRleHR1cmU7XHJcblxyXG4gICAgICAgICAgICBvdXQgdmVjNCBvdXRDb2xvcjtcclxuICAgICAgICBgLFxyXG4gICAgICAgIG1haW46IC8qIGdsc2wgKi8gYFxyXG4gICAgICAgICAgICBpdmVjMiBmcmFnQ29vcmQgPSBpdmVjMihnbF9GcmFnQ29vcmQueHkpO1xyXG4gICAgICAgICAgICB2ZWMyIHRleF9zaXplID0gdmVjMih0ZXh0dXJlU2l6ZSh1X3N1bW1lZHRleHR1cmUsIDApKTtcclxuXHJcbiAgICAgICAgICAgIHZlYzIgbWluQ29vcmQgPSBjbGFtcCh2ZWMyKGZyYWdDb29yZCkgLSB1X2JsdXJhbW91bnQsIHZlYzIoMC4wKSwgdGV4X3NpemUpO1xyXG4gICAgICAgICAgICB2ZWMyIG1heENvb3JkID0gY2xhbXAodmVjMihmcmFnQ29vcmQpICsgdV9ibHVyYW1vdW50LCB2ZWMyKDAuMCksIHRleF9zaXplKTtcclxuXHJcbiAgICAgICAgICAgIHZlYzQgcGl4ZWxDb2xvdXIgPSBhdmVyYWdlU3VtbWVkKHVfc3VtbWVkdGV4dHVyZSwgdV90ZXh0dXJlLCBtaW5Db29yZCwgbWF4Q29vcmQpO1xyXG5cclxuICAgICAgICAgICAgb3V0Q29sb3IgPSBwaXhlbENvbG91ciAvIDI1NS4wO1xyXG4gICAgICAgIGBcclxuICAgIH1cclxufTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5hdmVyYWdlU3VtbWVkID0gdm9pZCAwO1xyXG5jb25zdCBnZXRQaXhlbF8xID0gcmVxdWlyZShcIi4vZ2V0UGl4ZWxcIik7XHJcbmNvbnN0IGdldFN1bW1lZEFyZWFfMSA9IHJlcXVpcmUoXCIuL2dldFN1bW1lZEFyZWFcIik7XHJcbmV4cG9ydHMuYXZlcmFnZVN1bW1lZCA9IHtcclxuICAgIGRlcGVuZGVuY2llczogW2dldFBpeGVsXzEuZ2V0UGl4ZWwsIGdldFN1bW1lZEFyZWFfMS5nZXRTdW1tZWRBcmVhXSxcclxuICAgIHRleHQ6IC8qIGdsc2wgKi8gYFxyXG4gICAgICAgIC8vcmVzdWx0cyBpbiB1cCB0byAyNCB0ZXh0dXJlIGxvb2t1cHMgYmFzZWQgb24gY29tcGxleGl0eSBvZiByYW5nZSwgd2hhdGV2ZXIgc2l6ZSB0aGUgaW1hZ2UgaXNcclxuICAgICAgICB2ZWM0IGF2ZXJhZ2VTdW1tZWQoY29uc3QgaW4gdXNhbXBsZXIyRCBzdW1tZWRUZXh0dXJlLCBjb25zdCBpbiBzYW1wbGVyMkQgdGV4dHVyZSwgY29uc3QgaW4gdmVjMiBtaW5Db29yZCwgY29uc3QgaW4gdmVjMiBtYXhDb29yZCkge1xyXG4gICAgICAgICAgICBpdmVjMiBzdGFydENlbGwgPSBpdmVjMihmbG9vcihtaW5Db29yZCkpO1xyXG4gICAgICAgICAgICBpdmVjMiBlbmRDZWxsID0gaXZlYzIoZmxvb3IobWF4Q29vcmQpKTtcclxuXHJcbiAgICAgICAgICAgIC8vcmFuZ2UgY29udGFpbmVkIGluIG9uZSBwaXhlbFxyXG4gICAgICAgICAgICBpZiAoc3RhcnRDZWxsID09IGVuZENlbGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ZXhlbEZldGNoKHRleHR1cmUsIGl2ZWMyKHN0YXJ0Q2VsbCksIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2ZWMyIHNpemUgPSBtYXhDb29yZCAtIG1pbkNvb3JkO1xyXG4gICAgICAgICAgICBmbG9hdCBwaXhlbEFyZWEgPSBzaXplLnggKiBzaXplLnk7XHJcbiAgICAgICAgICAgIGZsb2F0IGNvbG91ck5vcm1hbGlzZXIgPSAxLjAgLyBwaXhlbEFyZWE7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpdmVjMiBpbm5lckNlbGwgPSBpdmVjMihjZWlsKG1pbkNvb3JkKSk7XHJcbiAgICAgICAgICAgIGl2ZWMyIGlubmVyQ2VsbDIgPSBpdmVjMihmbG9vcihtYXhDb29yZCkpO1xyXG5cclxuICAgICAgICAgICAgdmVjMiBtaW5EaWZmID0gdmVjMihpbm5lckNlbGwpIC0gbWluQ29vcmQ7XHJcbiAgICAgICAgICAgIHZlYzIgbWF4RGlmZiA9IG1heENvb3JkIC0gdmVjMihpbm5lckNlbGwyKTtcclxuXHJcbiAgICAgICAgICAgIHZlYzQgY29sb3VyID0gdmVjNCgwLjApO1xyXG5cclxuICAgICAgICAgICAgLy9UT0RPOiBvcHRpbWlzZSBieSByZW1vdmluZyBicmFuY2hlc1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy9zaW5nbGUgaG9yaXpvbnRhbCBzdHJpcFxyXG4gICAgICAgICAgICBpZiAoc3RhcnRDZWxsLnggPT0gZW5kQ2VsbC54KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWluRGlmZi55ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFBpeGVsKHRleHR1cmUsIHN0YXJ0Q2VsbCkgKiBzaXplLnggKiBtaW5EaWZmLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1heERpZmYueSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRQaXhlbCh0ZXh0dXJlLCBlbmRDZWxsKSAqIHNpemUueCAqIG1heERpZmYueTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0U3VtbWVkQXJlYShzdW1tZWRUZXh0dXJlLCBpdmVjMihzdGFydENlbGwueCwgaW5uZXJDZWxsLnkpLTEsIGl2ZWMyKHN0YXJ0Q2VsbC54LCBpbm5lckNlbGwyLnktMSkpICogc2l6ZS54O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZsb29yKGNvbG91ciAqIGNvbG91ck5vcm1hbGlzZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvL3NpbmdsZSB2ZXJ0aWNhbCBzdHJpcFxyXG4gICAgICAgICAgICBpZiAoc3RhcnRDZWxsLnkgPT0gZW5kQ2VsbC55KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWluRGlmZi54ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFBpeGVsKHRleHR1cmUsIHN0YXJ0Q2VsbCkgKiBzaXplLnkgKiBtaW5EaWZmLng7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1heERpZmYueCA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRQaXhlbCh0ZXh0dXJlLCBlbmRDZWxsKSAqIHNpemUueSAqIG1heERpZmYueDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0U3VtbWVkQXJlYShzdW1tZWRUZXh0dXJlLCBpdmVjMihpbm5lckNlbGwueCwgc3RhcnRDZWxsLnkpLTEsIGl2ZWMyKGlubmVyQ2VsbDIueC0xLCBzdGFydENlbGwueSkpICogc2l6ZS55O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZsb29yKGNvbG91ciAqIGNvbG91ck5vcm1hbGlzZXIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL2Nvcm5lciBjZWxsc1xyXG4gICAgICAgICAgICBpZiAobWluRGlmZi55ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWluRGlmZi54ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFBpeGVsKHRleHR1cmUsIHN0YXJ0Q2VsbCkgKiBtaW5EaWZmLnggKiBtaW5EaWZmLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1heERpZmYueCA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG91ciArPSBnZXRQaXhlbCh0ZXh0dXJlLCBpdmVjMihlbmRDZWxsLngsIHN0YXJ0Q2VsbC55KSkgKiBtYXhEaWZmLnggKiBtaW5EaWZmLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtYXhEaWZmLnkgPiAwLjApIHtcclxuICAgICAgICAgICAgICAgIGlmIChtaW5EaWZmLnggPiAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0UGl4ZWwodGV4dHVyZSwgaXZlYzIoc3RhcnRDZWxsLngsIGVuZENlbGwueSkpICogbWluRGlmZi54ICogbWF4RGlmZi55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXhEaWZmLnggPiAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0UGl4ZWwodGV4dHVyZSwgZW5kQ2VsbCkgKiBtYXhEaWZmLnggKiBtYXhEaWZmLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vZnJhY3Rpb25hbCBzdHJpcHNcclxuICAgICAgICAgICAgaWYgKG1pbkRpZmYueSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoaW5uZXJDZWxsLngsIHN0YXJ0Q2VsbC55KS0xLCBpdmVjMihpbm5lckNlbGwyLngtMSwgc3RhcnRDZWxsLnkpKSAqIG1pbkRpZmYueTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG1pbkRpZmYueCA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoc3RhcnRDZWxsLngsIGlubmVyQ2VsbC55KS0xLCBpdmVjMihzdGFydENlbGwueCwgaW5uZXJDZWxsMi55LTEpKSAqIG1pbkRpZmYueDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG1heERpZmYueSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoaW5uZXJDZWxsLngsIGVuZENlbGwueSktMSwgaXZlYzIoaW5uZXJDZWxsMi54LTEsIGVuZENlbGwueSkpICogbWF4RGlmZi55O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobWF4RGlmZi54ID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICBjb2xvdXIgKz0gZ2V0U3VtbWVkQXJlYShzdW1tZWRUZXh0dXJlLCBpdmVjMihlbmRDZWxsLngsIGlubmVyQ2VsbC55KS0xLCBpdmVjMihlbmRDZWxsLngsIGlubmVyQ2VsbDIueS0xKSkgKiBtYXhEaWZmLng7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vaW5uZXIgcGFydHNcclxuICAgICAgICAgICAgY29sb3VyICs9IGdldFN1bW1lZEFyZWEoc3VtbWVkVGV4dHVyZSwgaXZlYzIoaW5uZXJDZWxsKS0xLCBpdmVjMihpbm5lckNlbGwyKS0xKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vbm93IHdlIGhhdmUgYW4gYWNjdW11bGF0aXZlIHBpeGVsIHZhbHVlIHRoYXQgY292ZXJzIHRoZSB3aG9sZSBhcmVhIHNvIGp1c3QgYXZlcmFnZSBpdFxyXG4gICAgICAgICAgICByZXR1cm4gZmxvb3IoY29sb3VyICogY29sb3VyTm9ybWFsaXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgYFxyXG59O1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmdldFBpeGVsID0gdm9pZCAwO1xyXG5leHBvcnRzLmdldFBpeGVsID0ge1xyXG4gICAgdGV4dDogLyogZ2xzbCAqLyBgXHJcbiAgICAgICAgdmVjNCBnZXRQaXhlbChjb25zdCBpbiBzYW1wbGVyMkQgdGV4dHVyZSwgY29uc3QgaW4gaXZlYzIgcG9zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXhlbEZldGNoKHRleHR1cmUsIHBvcywgMCkgKiAyNTUuMDtcclxuICAgICAgICB9XHJcbiAgICBgXHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuZ2V0U3VtbWVkQXJlYSA9IHZvaWQgMDtcclxuZXhwb3J0cy5nZXRTdW1tZWRBcmVhID0ge1xyXG4gICAgdGV4dDogLyogZ2xzbCAqLyBgXHJcbiAgICAgICAgdmVjNCBnZXRTdW1tZWRBcmVhKGNvbnN0IGluIHVzYW1wbGVyMkQgc3VtbWVkVGV4dHVyZSwgY29uc3QgaW4gaXZlYzIgbWluQ29vcmQsIGNvbnN0IGluIGl2ZWMyIG1heENvb3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2ZWM0KHRleGVsRmV0Y2goc3VtbWVkVGV4dHVyZSwgbWF4Q29vcmQsIDApIC0gXHJcbiAgICAgICAgICAgICAgICB0ZXhlbEZldGNoKHN1bW1lZFRleHR1cmUsIGl2ZWMyKG1pbkNvb3JkLngsIG1heENvb3JkLnkpLCAwKSArIFxyXG4gICAgICAgICAgICAgICAgdGV4ZWxGZXRjaChzdW1tZWRUZXh0dXJlLCBtaW5Db29yZCwgMCkgLVxyXG4gICAgICAgICAgICAgICAgdGV4ZWxGZXRjaChzdW1tZWRUZXh0dXJlLCBpdmVjMihtYXhDb29yZC54LCBtaW5Db29yZC55KSwgMCkpO1xyXG4gICAgICAgIH1cclxuICAgIGBcclxufTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5hZGQ0TXV0YXRlID0gdm9pZCAwO1xyXG5jb25zdCBhZGQ0TXV0YXRlID0gKGEsIGIpID0+IHtcclxuICAgIGFbMF0gKz0gYlswXTtcclxuICAgIGFbMV0gKz0gYlsxXTtcclxuICAgIGFbMl0gKz0gYlsyXTtcclxuICAgIGFbM10gKz0gYlszXTtcclxuICAgIHJldHVybiBhO1xyXG59O1xyXG5leHBvcnRzLmFkZDRNdXRhdGUgPSBhZGQ0TXV0YXRlO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmdldEltYWdlRGF0YSA9IHZvaWQgMDtcclxuY29uc3QgZ2V0SW1hZ2VEYXRhID0gKGltYWdlKSA9PiB7XHJcbiAgICBjb25zdCBpbWFnZUNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgaW1hZ2VDYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDtcclxuICAgIGltYWdlQ2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDtcclxuICAgIGNvbnN0IGltYWdlR3JhcGhpY3MgPSBpbWFnZUNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgaWYgKCFpbWFnZUdyYXBoaWNzKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgY3JlYXRlIGNhbnZhcyB0byBleHRyYWN0IGltYWdlIGRhdGEnKTtcclxuICAgIH1cclxuICAgIGltYWdlR3JhcGhpY3MuY2xlYXJSZWN0KDAsIDAsIGltYWdlQ2FudmFzLndpZHRoLCBpbWFnZUNhbnZhcy5oZWlnaHQpO1xyXG4gICAgaW1hZ2VHcmFwaGljcy5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDApO1xyXG4gICAgcmV0dXJuIGltYWdlR3JhcGhpY3MuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlQ2FudmFzLndpZHRoLCBpbWFnZUNhbnZhcy5oZWlnaHQpO1xyXG59O1xyXG5leHBvcnRzLmdldEltYWdlRGF0YSA9IGdldEltYWdlRGF0YTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5zdWJ0cmFjdDRNdXRhdGUgPSB2b2lkIDA7XHJcbmNvbnN0IHN1YnRyYWN0NE11dGF0ZSA9IChhLCBiKSA9PiB7XHJcbiAgICBhWzBdIC09IGJbMF07XHJcbiAgICBhWzFdIC09IGJbMV07XHJcbiAgICBhWzJdIC09IGJbMl07XHJcbiAgICBhWzNdIC09IGJbM107XHJcbiAgICByZXR1cm4gYTtcclxufTtcclxuZXhwb3J0cy5zdWJ0cmFjdDRNdXRhdGUgPSBzdWJ0cmFjdDRNdXRhdGU7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuYnVpbGRTaGFkZXJTdGFnZSA9IHZvaWQgMDtcclxuY29uc3QgZGVmaW5lU2hhZGVyU25pcHBldF8xID0gcmVxdWlyZShcIi4vZGVmaW5lU2hhZGVyU25pcHBldFwiKTtcclxuY29uc3QgYnVpbGRTaGFkZXJTdGFnZSA9IChzaGFkZXIsIHZlcnNpb24pID0+IHtcclxuICAgIHZhciBfYTtcclxuICAgIGxldCB0ZXN0RGVwZW5kZW5jaWVzID0gbmV3IFNldChzaGFkZXIuZGVwZW5kZW5jaWVzIHx8IFtdKTtcclxuICAgIGNvbnN0IGFsbERlcGVuZGVuY2llcyA9IG5ldyBTZXQodGVzdERlcGVuZGVuY2llcyk7XHJcbiAgICBsZXQgbmV4dFNldDtcclxuICAgIGNvbnN0IGFkZERlcGVuZGVuY2llcyA9IChkZXBlbmRlbmNpZXMpID0+IHtcclxuICAgICAgICBpZiAoZGVwZW5kZW5jaWVzKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3ViZGVwZW5kZW5jeSBvZiBkZXBlbmRlbmNpZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhbGxEZXBlbmRlbmNpZXMuaGFzKHN1YmRlcGVuZGVuY3kpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxsRGVwZW5kZW5jaWVzLmRlbGV0ZShzdWJkZXBlbmRlbmN5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRTZXQuYWRkKHN1YmRlcGVuZGVuY3kpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYWxsRGVwZW5kZW5jaWVzLmFkZChzdWJkZXBlbmRlbmN5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB3aGlsZSAodGVzdERlcGVuZGVuY2llcy5zaXplKSB7XHJcbiAgICAgICAgbmV4dFNldCA9IG5ldyBTZXQoKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGRlcGVuZGVuY3kgb2YgdGVzdERlcGVuZGVuY2llcykge1xyXG4gICAgICAgICAgICBpZiAoJ3NuaXBwZXQnIGluIGRlcGVuZGVuY3kpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gZGVwZW5kZW5jeTtcclxuICAgICAgICAgICAgICAgIGFkZERlcGVuZGVuY2llcyhpbnN0YW5jZS5zbmlwcGV0LmRlcGVuZGVuY2llcyk7XHJcbiAgICAgICAgICAgICAgICBhZGREZXBlbmRlbmNpZXMoaW5zdGFuY2UucGFyYW1zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhZGREZXBlbmRlbmNpZXMoZGVwZW5kZW5jeS5kZXBlbmRlbmNpZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0ZXN0RGVwZW5kZW5jaWVzID0gbmV4dFNldDtcclxuICAgIH1cclxuICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IEFycmF5LmZyb20oYWxsRGVwZW5kZW5jaWVzLnZhbHVlcygpKS5yZXZlcnNlKCk7XHJcbiAgICByZXR1cm4gYCN2ZXJzaW9uICR7dmVyc2lvbn1cclxuXHJcbiAgICAgICAgJHsoX2EgPSBzaGFkZXIuaGVhZCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogJyd9XHJcblxyXG4gICAgICAgICR7ZGVwZW5kZW5jaWVzXHJcbiAgICAgICAgLm1hcCgoZGVwZW5kZW5jeSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRlcCA9IGRlcGVuZGVuY3k7XHJcbiAgICAgICAgaWYgKCdzbmlwcGV0JyBpbiBkZXApIHtcclxuICAgICAgICAgICAgcmV0dXJuICgwLCBkZWZpbmVTaGFkZXJTbmlwcGV0XzEuZGVmaW5lU2hhZGVyU25pcHBldCkoZGVwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZXAudGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgICAgIC5qb2luKCdcXG4nKX1cclxuICAgIFxyXG4gICAgICAgIHZvaWQgbWFpbih2b2lkKSB7XHJcbiAgICAgICAgICAgICR7c2hhZGVyLm1haW59XHJcbiAgICAgICAgfVxyXG4gICAgYDtcclxufTtcclxuZXhwb3J0cy5idWlsZFNoYWRlclN0YWdlID0gYnVpbGRTaGFkZXJTdGFnZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5jcmVhdGVQcm9ncmFtID0gdm9pZCAwO1xyXG5jb25zdCBjcmVhdGVQcm9ncmFtID0gKGdsLCB2ZXJ0U2hhZGVyLCBmcmFnU2hhZGVyKSA9PiB7XHJcbiAgICBjb25zdCBwcm9ncmFtID0gZ2wuY3JlYXRlUHJvZ3JhbSgpO1xyXG4gICAgaWYgKHByb2dyYW0gPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBjcmVhdGUgcHJvZ3JhbScpO1xyXG4gICAgfVxyXG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHZlcnRTaGFkZXIpO1xyXG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGZyYWdTaGFkZXIpO1xyXG4gICAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7XHJcbiAgICBjb25zdCBsaW5rZWQgPSBnbC5nZXRQcm9ncmFtUGFyYW1ldGVyKHByb2dyYW0sIGdsLkxJTktfU1RBVFVTKTtcclxuICAgIGlmICghbGlua2VkKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZ2wuZ2V0UHJvZ3JhbUluZm9Mb2cocHJvZ3JhbSk7XHJcbiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShwcm9ncmFtKTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGxpbmtpbmcgcHJvZ3JhbSA6ICR7ZXJyb3JNZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHByb2dyYW07XHJcbn07XHJcbmV4cG9ydHMuY3JlYXRlUHJvZ3JhbSA9IGNyZWF0ZVByb2dyYW07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXIgPSB2b2lkIDA7XHJcbmNvbnN0IGJ1aWxkU2hhZGVyU3RhZ2VfMSA9IHJlcXVpcmUoXCIuL2J1aWxkU2hhZGVyU3RhZ2VcIik7XHJcbmNvbnN0IGNyZWF0ZVByb2dyYW1fMSA9IHJlcXVpcmUoXCIuL2NyZWF0ZVByb2dyYW1cIik7XHJcbmNvbnN0IGxvYWRTaGFkZXJfMSA9IHJlcXVpcmUoXCIuL2xvYWRTaGFkZXJcIik7XHJcbmNvbnN0IGNyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyID0gKGdsLCBzaGFkZXIpID0+IHtcclxuICAgIGNvbnN0IHZlcnRTb3VyY2UgPSAoMCwgYnVpbGRTaGFkZXJTdGFnZV8xLmJ1aWxkU2hhZGVyU3RhZ2UpKHNoYWRlci52ZXJ0ZXgsIHNoYWRlci52ZXJzaW9uKTtcclxuICAgIGNvbnN0IGZyYWdTb3VyY2UgPSAoMCwgYnVpbGRTaGFkZXJTdGFnZV8xLmJ1aWxkU2hhZGVyU3RhZ2UpKHNoYWRlci5mcmFnbWVudCwgc2hhZGVyLnZlcnNpb24pO1xyXG4gICAgY29uc3QgdmVydFNoYWRlciA9ICgwLCBsb2FkU2hhZGVyXzEubG9hZFNoYWRlcikoZ2wsIHZlcnRTb3VyY2UsIGdsLlZFUlRFWF9TSEFERVIpO1xyXG4gICAgY29uc3QgZnJhZ1NoYWRlciA9ICgwLCBsb2FkU2hhZGVyXzEubG9hZFNoYWRlcikoZ2wsIGZyYWdTb3VyY2UsIGdsLkZSQUdNRU5UX1NIQURFUik7XHJcbiAgICByZXR1cm4gKDAsIGNyZWF0ZVByb2dyYW1fMS5jcmVhdGVQcm9ncmFtKShnbCwgdmVydFNoYWRlciwgZnJhZ1NoYWRlcik7XHJcbn07XHJcbmV4cG9ydHMuY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXIgPSBjcmVhdGVQcm9ncmFtRnJvbVNoYWRlcjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5kZWZpbmVTaGFkZXJTbmlwcGV0ID0gdm9pZCAwO1xyXG5jb25zdCBzbmlwcGV0UmVzdWx0XzEgPSByZXF1aXJlKFwiLi9zbmlwcGV0UmVzdWx0XCIpO1xyXG5jb25zdCBkZWZpbmVTaGFkZXJTbmlwcGV0ID0gKGluc3RhbmNlKSA9PiB7XHJcbiAgICB2YXIgX2EsIF9iO1xyXG4gICAgY29uc3QgZnVuY1BhcmFtcyA9IFtcclxuICAgICAgICAuLi5pbnN0YW5jZS5zbmlwcGV0LnBhcmFtcyxcclxuICAgICAgICAuLi5pbnN0YW5jZS5yZXN1bHRPYmpzLm1hcCgocGFyYW0pID0+IChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHBhcmFtKSwgeyBuYW1lOiBgJHtzbmlwcGV0UmVzdWx0XzEuc25pcHBldFJlc3VsdH0ke3BhcmFtLm5hbWV9YCB9KSkpXHJcbiAgICBdLm1hcCgocGFyYW0pID0+IGAke3BhcmFtLnF1YWxpZmllcn0gJHtwYXJhbS50eXBlfSAke3BhcmFtLm5hbWV9YCk7XHJcbiAgICByZXR1cm4gYCR7KF9hID0gaW5zdGFuY2Uuc25pcHBldC5yZXR1cm5UeXBlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAndm9pZCd9ICR7aW5zdGFuY2UubmFtZX0oJHtmdW5jUGFyYW1zLmpvaW4oJywnKX0pIHtcclxuICAgICAgICAke2luc3RhbmNlLnNuaXBwZXQudGV4dCguLi4oKF9iID0gaW5zdGFuY2UucGFyYW1zKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBbXSkpfVxyXG4gICAgfWA7XHJcbn07XHJcbmV4cG9ydHMuZGVmaW5lU2hhZGVyU25pcHBldCA9IGRlZmluZVNoYWRlclNuaXBwZXQ7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMubG9hZFNoYWRlciA9IHZvaWQgMDtcclxuY29uc3QgbG9hZFNoYWRlciA9IChnbCwgc291cmNlLCB0eXBlKSA9PiB7XHJcbiAgICBjb25zdCBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIodHlwZSk7XHJcbiAgICBpZiAoc2hhZGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgY3JlYXRlIHNoYWRlcicpO1xyXG4gICAgfVxyXG4gICAgZ2wuc2hhZGVyU291cmNlKHNoYWRlciwgc291cmNlKTtcclxuICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTtcclxuICAgIGNvbnN0IGNvbXBpbGVkID0gZ2wuZ2V0U2hhZGVyUGFyYW1ldGVyKHNoYWRlciwgZ2wuQ09NUElMRV9TVEFUVVMpO1xyXG4gICAgaWYgKCFjb21waWxlZCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGdsLmdldFNoYWRlckluZm9Mb2coc2hhZGVyKTtcclxuICAgICAgICBnbC5kZWxldGVTaGFkZXIoc2hhZGVyKTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGNvbXBpbGluZyBzaGFkZXI6ICR7ZXJyb3JNZXNzYWdlfVxcbiR7c291cmNlXHJcbiAgICAgICAgICAgIC5zcGxpdCgnXFxuJylcclxuICAgICAgICAgICAgLm1hcCgoc3RyLCBpbmRleCkgPT4gYCR7aW5kZXggKyAxfToke3N0cn1gKVxyXG4gICAgICAgICAgICAuam9pbignXFxuJyl9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2hhZGVyO1xyXG59O1xyXG5leHBvcnRzLmxvYWRTaGFkZXIgPSBsb2FkU2hhZGVyO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLnNuaXBwZXRSZXN1bHQgPSB2b2lkIDA7XHJcbmV4cG9ydHMuc25pcHBldFJlc3VsdCA9ICdfcmVzdWx0Xyc7XHJcbiJdLCJuYW1lcyI6WyJjcmVhdGVSZW5kZXJlcl8xIiwiY3JlYXRlU3VtbWVkVGV4dHVyZVdlYmdsXzEiLCJtYWtlTG9nU2NhbGVfMSIsImdldEltYWdlRGF0YV8xIiwiY3JlYXRlUHJvZ3JhbUZyb21TaGFkZXJfMSIsImJsdXJfMSIsImdhbWUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW1hZ2UiLCJhbW91bnRJbnB1dCIsImFtb3VudFZhbHVlSW5wdXQiLCJ0aW1ldGFrZW4iLCJnbCIsImdldENvbnRleHQiLCJFcnJvciIsImJsdXJVbmlmb3JtTG9jYXRpb24iLCJibHVyQW1vdW50Iiwic3RhcnQiLCJibHVyTG9nU2NhbGUiLCJtYWtlTG9nU2NhbGUiLCJjbGVhckNvbG9yIiwicHJvZ3JhbSIsImNyZWF0ZVByb2dyYW1Gcm9tU2hhZGVyIiwiYmx1ciIsInNjcmVlblRyaWFuZ2xlIiwiY3JlYXRlVmVydGV4QXJyYXkiLCJiaW5kVmVydGV4QXJyYXkiLCJwb3NpdGlvbkJ1ZmZlciIsImNyZWF0ZUJ1ZmZlciIsImJpbmRCdWZmZXIiLCJBUlJBWV9CVUZGRVIiLCJidWZmZXJEYXRhIiwiRmxvYXQzMkFycmF5IiwiU1RBVElDX0RSQVciLCJ0ZXh0dXJlIiwiY3JlYXRlVGV4dHVyZSIsImJpbmRUZXh0dXJlIiwiVEVYVFVSRV8yRCIsInBpeGVsU3RvcmVpIiwiVU5QQUNLX0ZMSVBfWV9XRUJHTCIsInRleEltYWdlMkQiLCJSR0JBIiwiVU5TSUdORURfQllURSIsImdlbmVyYXRlTWlwbWFwIiwid2lkdGgiLCJoZWlnaHQiLCJzdW1tZWRJbWFnZSIsImNyZWF0ZVN1bW1lZFRleHR1cmVXZWJnbCIsImdldEltYWdlRGF0YSIsInN1bW1lZFRleHR1cmUiLCJSR0JBMzJVSSIsIlJHQkFfSU5URUdFUiIsIlVOU0lHTkVEX0lOVCIsInRleFBhcmFtZXRlcmkiLCJURVhUVVJFX01BR19GSUxURVIiLCJORUFSRVNUIiwiVEVYVFVSRV9NSU5fRklMVEVSIiwiVEVYVFVSRV9XUkFQX1MiLCJDTEFNUF9UT19FREdFIiwiVEVYVFVSRV9XUkFQX1QiLCJ1c2VQcm9ncmFtIiwicG9zaXRpb25BdHRyaWJ1dGVMb2NhdGlvbiIsImdldEF0dHJpYkxvY2F0aW9uIiwiZW5hYmxlVmVydGV4QXR0cmliQXJyYXkiLCJ2ZXJ0ZXhBdHRyaWJQb2ludGVyIiwiRkxPQVQiLCJ0ZXh0dXJlVW5pZm9ybUxvY2F0aW9uIiwiZ2V0VW5pZm9ybUxvY2F0aW9uIiwidW5pZm9ybTFpIiwiYWN0aXZlVGV4dHVyZSIsIlRFWFRVUkUwIiwic3VtbWVkVGV4dHVyZVVuaWZvcm1Mb2NhdGlvbiIsIlRFWFRVUkUxIiwiZHJhdyIsImNyZWF0ZVJlbmRlcmVyIiwidmFsdWUiLCJ0b1N0cmluZyIsInRvTGluZWFyIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInZpZXdwb3J0IiwiY2FudmFzIiwiY2xlYXIiLCJDT0xPUl9CVUZGRVJfQklUIiwiREVQVEhfQlVGRkVSX0JJVCIsInVuaWZvcm0xZiIsImRyYXdBcnJheXMiLCJUUklBTkdMRVMiLCJyZWFkUGl4ZWxzIiwiVWludDhBcnJheSIsImlubmVyVGV4dCIsInJlbmRlciIsIm9uaW5wdXQiLCJwYXJzZUZsb2F0IiwiZnJvbUxpbmVhciIsInRvRml4ZWQiLCJvbmNoYW5nZSIsImNvbXBsZXRlIiwib25sb2FkIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwicmVuZGVyRnVuYyIsImFmdGVyUmVuZGVyRnVuYyIsImRyYXdpbmciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJhZGQ0TXV0YXRlXzEiLCJzdWJ0cmFjdDRNdXRhdGVfMSIsImltYWdlRGF0YSIsIkFycmF5IiwieSIsIngiLCJpIiwicGl4IiwiVWludDMyQXJyYXkiLCJkYXRhIiwic2xpY2UiLCJhZGQ0TXV0YXRlIiwic3VidHJhY3Q0TXV0YXRlIiwic3VtbWVkSW1hZ2VSYXciLCJyb3ciLCJmcm9tIiwidG8iLCJtaW4iLCJNYXRoIiwibG9nIiwic2NhbGUiLCJleHAiLCJsb2dWYWx1ZSIsImF2ZXJhZ2VTdW1tZWRfMSIsInZlcnNpb24iLCJ2ZXJ0ZXgiLCJoZWFkIiwibWFpbiIsImZyYWdtZW50IiwiZGVwZW5kZW5jaWVzIiwiYXZlcmFnZVN1bW1lZCIsImdldFBpeGVsXzEiLCJnZXRTdW1tZWRBcmVhXzEiLCJnZXRQaXhlbCIsImdldFN1bW1lZEFyZWEiLCJ0ZXh0IiwiYSIsImIiLCJpbWFnZUNhbnZhcyIsImNyZWF0ZUVsZW1lbnQiLCJpbWFnZUdyYXBoaWNzIiwiY2xlYXJSZWN0IiwiZHJhd0ltYWdlIiwiYnVpbGRTaGFkZXJTdGFnZSIsImRlZmluZVNoYWRlclNuaXBwZXRfMSIsInNoYWRlciIsIl9hIiwidGVzdERlcGVuZGVuY2llcyIsIlNldCIsImFsbERlcGVuZGVuY2llcyIsIm5leHRTZXQiLCJhZGREZXBlbmRlbmNpZXMiLCJzdWJkZXBlbmRlbmN5IiwiaGFzIiwiZGVsZXRlIiwiYWRkIiwic2l6ZSIsImRlcGVuZGVuY3kiLCJpbnN0YW5jZSIsInNuaXBwZXQiLCJwYXJhbXMiLCJ2YWx1ZXMiLCJyZXZlcnNlIiwibWFwIiwiZGVwIiwiZGVmaW5lU2hhZGVyU25pcHBldCIsImpvaW4iLCJjcmVhdGVQcm9ncmFtIiwidmVydFNoYWRlciIsImZyYWdTaGFkZXIiLCJhdHRhY2hTaGFkZXIiLCJsaW5rUHJvZ3JhbSIsImdldFByb2dyYW1QYXJhbWV0ZXIiLCJMSU5LX1NUQVRVUyIsImVycm9yTWVzc2FnZSIsImdldFByb2dyYW1JbmZvTG9nIiwiZGVsZXRlUHJvZ3JhbSIsImJ1aWxkU2hhZGVyU3RhZ2VfMSIsImNyZWF0ZVByb2dyYW1fMSIsImxvYWRTaGFkZXJfMSIsInZlcnRTb3VyY2UiLCJmcmFnU291cmNlIiwibG9hZFNoYWRlciIsIlZFUlRFWF9TSEFERVIiLCJGUkFHTUVOVF9TSEFERVIiLCJzbmlwcGV0UmVzdWx0XzEiLCJfYiIsImZ1bmNQYXJhbXMiLCJyZXN1bHRPYmpzIiwicGFyYW0iLCJhc3NpZ24iLCJuYW1lIiwic25pcHBldFJlc3VsdCIsInF1YWxpZmllciIsInR5cGUiLCJyZXR1cm5UeXBlIiwic291cmNlIiwiY3JlYXRlU2hhZGVyIiwic2hhZGVyU291cmNlIiwiY29tcGlsZVNoYWRlciIsImdldFNoYWRlclBhcmFtZXRlciIsIkNPTVBJTEVfU1RBVFVTIiwiZ2V0U2hhZGVySW5mb0xvZyIsImRlbGV0ZVNoYWRlciIsInNwbGl0Iiwic3RyIiwiaW5kZXgiXSwic291cmNlUm9vdCI6IiJ9